

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building a new plot &mdash; sisl</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom_styles.css?v=cafe85c1" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=9d09c2c4"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=7800a641"></script>
      <script src="../../_static/tabs.js?v=3ee01567"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adding new backends" href="Adding%20new%20backends.html" />
    <link rel="prev" title="Intro to combining plots" href="../combining-plots/Intro%20to%20combining%20plots.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            sisl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Citing sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.viz</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-tutorials">Basic Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#showcase-of-plot-classes">Showcase of plot classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#using-it-with-blender">Using it with blender</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#combining-plots">Combining plots</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#do-it-yourself">Do it yourself</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Building a new plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#The-tools">The tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#A-plot-function">A plot function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#From-function-to-Plot">From function to <code class="docutils literal notranslate"><span class="pre">Plot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Additional-methods">Additional methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Complex-plots">Complex plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="Adding%20new%20backends.html">Adding new backends</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/index.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../environment.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../toolbox/index.html">Toolboxes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev/index.html">Contributing to sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../math.html">Mathematical notation convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other.html">Related software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.viz</span></code>)</a></li>
      <li class="breadcrumb-item active">Building a new plot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/visualization/diy/Building a new plot.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div align="right">
<a href="https://raw.githubusercontent.com/zerothi/sisl/main/docs/visualization/diy/Building a new plot.ipynb">
    <img alt="ipynb download badge"
        src="https://img.shields.io/badge/download-ipynb-blue.svg"
        style="vertical-align:text-bottom">
</a>
&nbsp;
<a href="https://mybinder.org/v2/gh/zerothi/sisl/main?filepath=docs/visualization/diy/Building a new plot.ipynb">
   <img alt="Binder badge"
        src="https://mybinder.org/badge_logo.svg"
        style="vertical-align:text-bottom">
</a>
</div><section id="Building-a-new-plot">
<h1>Building a new plot<a class="headerlink" href="#Building-a-new-plot" title="Link to this heading"></a></h1>
<p><strong>Following this guide</strong>, you will create a new plot in no time. Remember to check the <a class="reference internal" href="../basic-tutorials/Demo.html"><span class="doc">introduction notebook to the framework</span></a> to understand that:</p>
<ul class="simple">
<li><p>Your plot will support multiple plotting backends.</p></li>
<li><p>Your plot will only recompute what is needed when its inputs are updated.</p></li>
</ul>
<p>Let’s get started!</p>
</section>
<section id="The-tools">
<h1>The tools<a class="headerlink" href="#The-tools" title="Link to this heading"></a></h1>
<p>We provide you with a set of tools to create plots. The most basic ones are two of them: <code class="docutils literal notranslate"><span class="pre">get_figure</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_actions</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sisl.viz</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_figure</span><span class="p">,</span> <span class="n">plot_actions</span>
</pre></div>
</div>
</div>
<p>They are what support the multibackend framework. Let’s try them out:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We create an action.</span>
<span class="n">action</span> <span class="o">=</span> <span class="n">plot_actions</span><span class="o">.</span><span class="n">draw_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">})</span>

<span class="c1"># And then we plot it in a figure</span>
<span class="n">get_figure</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;plotly&quot;</span><span class="p">,</span> <span class="n">plot_actions</span><span class="o">=</span><span class="p">[</span><span class="n">action</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_2.html"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
<p>Simple, isn’t it?</p>
<p>As you might have imagined, we can ask for a matplotlib figure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_figure</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">,</span> <span class="n">plot_actions</span><span class="o">=</span><span class="p">[</span><span class="n">action</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;sisl.viz.figure.matplotlib.MatplotlibFigure at 0x7f1ae82e5970&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/visualization_diy_Building_a_new_plot_6_1.png" src="../../_images/visualization_diy_Building_a_new_plot_6_1.png" />
</div>
</div>
</section>
<section id="A-plot-function">
<h1>A plot function<a class="headerlink" href="#A-plot-function" title="Link to this heading"></a></h1>
<p>It now feels reasonable to pack this very cool implementation this into a function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">a_cool_plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;plotly&quot;</span><span class="p">):</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">plot_actions</span><span class="o">.</span><span class="n">draw_line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">get_figure</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">plot_actions</span><span class="o">=</span><span class="p">[</span><span class="n">action</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>And just like that, <strong>you have your multi framework plot function</strong>. It would be a shame to leave it unused.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_cool_plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_5.html"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
<p>What is there left to do then? Remember that we wanted our plot to be a workflow, and currently it isn’t.</p>
</section>
<section id="From-function-to-Plot">
<h1>From function to <code class="docutils literal notranslate"><span class="pre">Plot</span></code><a class="headerlink" href="#From-function-to-Plot" title="Link to this heading"></a></h1>
<p>To convert our function to a workflow, we need to introduce a new tool, <code class="docutils literal notranslate"><span class="pre">Plot</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sisl.viz</span><span class="w"> </span><span class="kn">import</span> <span class="n">Plot</span>
</pre></div>
</div>
</div>
<p>It is just an extension of sisl’s <code class="docutils literal notranslate"><span class="pre">Workflow</span></code> class (see <code class="docutils literal notranslate"><span class="pre">sisl.nodes</span></code> documentation), so creating a <code class="docutils literal notranslate"><span class="pre">Plot</span></code> from a function is straightforward:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CoolPlot</span> <span class="o">=</span> <span class="n">Plot</span><span class="o">.</span><span class="n">from_func</span><span class="p">(</span><span class="n">a_cool_plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s now visualize our workflow!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CoolPlot</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="height:600px"><html>
    <head>
        <meta charset="utf-8">

            <script>function neighbourhoodHighlight(params) {
  // console.log("in nieghbourhoodhighlight");
  allNodes = nodes.get({ returnType: "Object" });
  // originalNodes = JSON.parse(JSON.stringify(allNodes));
  // if something is selected:
  if (params.nodes.length > 0) {
    highlightActive = true;
    var i, j;
    var selectedNode = params.nodes[0];
    var degrees = 2;

    // mark all nodes as hard to read.
    for (let nodeId in allNodes) {
      // nodeColors[nodeId] = allNodes[nodeId].color;
      allNodes[nodeId].color = "rgba(200,200,200,0.5)";
      if (allNodes[nodeId].hiddenLabel === undefined) {
        allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
        allNodes[nodeId].label = undefined;
      }
    }
    var connectedNodes = network.getConnectedNodes(selectedNode);
    var allConnectedNodes = [];

    // get the second degree nodes
    for (i = 1; i < degrees; i++) {
      for (j = 0; j < connectedNodes.length; j++) {
        allConnectedNodes = allConnectedNodes.concat(
          network.getConnectedNodes(connectedNodes[j])
        );
      }
    }

    // all second degree nodes get a different color and their label back
    for (i = 0; i < allConnectedNodes.length; i++) {
      // allNodes[allConnectedNodes[i]].color = "pink";
      allNodes[allConnectedNodes[i]].color = "rgba(150,150,150,0.75)";
      if (allNodes[allConnectedNodes[i]].hiddenLabel !== undefined) {
        allNodes[allConnectedNodes[i]].label =
          allNodes[allConnectedNodes[i]].hiddenLabel;
        allNodes[allConnectedNodes[i]].hiddenLabel = undefined;
      }
    }

    // all first degree nodes get their own color and their label back
    for (i = 0; i < connectedNodes.length; i++) {
      // allNodes[connectedNodes[i]].color = undefined;
      allNodes[connectedNodes[i]].color = nodeColors[connectedNodes[i]];
      if (allNodes[connectedNodes[i]].hiddenLabel !== undefined) {
        allNodes[connectedNodes[i]].label =
          allNodes[connectedNodes[i]].hiddenLabel;
        allNodes[connectedNodes[i]].hiddenLabel = undefined;
      }
    }

    // the main node gets its own color and its label back.
    // allNodes[selectedNode].color = undefined;
    allNodes[selectedNode].color = nodeColors[selectedNode];
    if (allNodes[selectedNode].hiddenLabel !== undefined) {
      allNodes[selectedNode].label = allNodes[selectedNode].hiddenLabel;
      allNodes[selectedNode].hiddenLabel = undefined;
    }
  } else if (highlightActive === true) {
    // console.log("highlightActive was true");
    // reset all nodes
    for (let nodeId in allNodes) {
      // allNodes[nodeId].color = "purple";
      allNodes[nodeId].color = nodeColors[nodeId];
      // delete allNodes[nodeId].color;
      if (allNodes[nodeId].hiddenLabel !== undefined) {
        allNodes[nodeId].label = allNodes[nodeId].hiddenLabel;
        allNodes[nodeId].hiddenLabel = undefined;
      }
    }
    highlightActive = false;
  }

  // transform the object into an array
  var updateArray = [];
  if (params.nodes.length > 0) {
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        // console.log(allNodes[nodeId]);
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  } else {
    // console.log("Nothing was selected");
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        // console.log(allNodes[nodeId]);
        // allNodes[nodeId].color = {};
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  }
}

function filterHighlight(params) {
  allNodes = nodes.get({ returnType: "Object" });
  // if something is selected:
  if (params.nodes.length > 0) {
    filterActive = true;
    let selectedNodes = params.nodes;

    // hiding all nodes and saving the label
    for (let nodeId in allNodes) {
      allNodes[nodeId].hidden = true;
      if (allNodes[nodeId].savedLabel === undefined) {
        allNodes[nodeId].savedLabel = allNodes[nodeId].label;
        allNodes[nodeId].label = undefined;
      }
    }

    for (let i=0; i < selectedNodes.length; i++) {
      allNodes[selectedNodes[i]].hidden = false;
      if (allNodes[selectedNodes[i]].savedLabel !== undefined) {
        allNodes[selectedNodes[i]].label = allNodes[selectedNodes[i]].savedLabel;
        allNodes[selectedNodes[i]].savedLabel = undefined;
      }
    }

  } else if (filterActive === true) {
    // reset all nodes
    for (let nodeId in allNodes) {
      allNodes[nodeId].hidden = false;
      if (allNodes[nodeId].savedLabel !== undefined) {
        allNodes[nodeId].label = allNodes[nodeId].savedLabel;
        allNodes[nodeId].savedLabel = undefined;
      }
    }
    filterActive = false;
  }

  // transform the object into an array
  var updateArray = [];
  if (params.nodes.length > 0) {
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  } else {
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  }
}

function selectNode(nodes) {
  network.selectNodes(nodes);
  neighbourhoodHighlight({ nodes: nodes });
  return nodes;
}

function selectNodes(nodes) {
  network.selectNodes(nodes);
  filterHighlight({nodes: nodes});
  return nodes;
}

function highlightFilter(filter) {
  let selectedNodes = []
  let selectedProp = filter['property']
  if (filter['item'] === 'node') {
    let allNodes = nodes.get({ returnType: "Object" });
    for (let nodeId in allNodes) {
      if (allNodes[nodeId][selectedProp] && filter['value'].includes((allNodes[nodeId][selectedProp]).toString())) {
        selectedNodes.push(nodeId)
      }
    }
  }
  else if (filter['item'] === 'edge'){
    let allEdges = edges.get({returnType: 'object'});
    // check if the selected property exists for selected edge and select the nodes connected to the edge
    for (let edge in allEdges) {
      if (allEdges[edge][selectedProp] && filter['value'].includes((allEdges[edge][selectedProp]).toString())) {
        selectedNodes.push(allEdges[edge]['from'])
        selectedNodes.push(allEdges[edge]['to'])
      }
    }
  }
  selectNodes(selectedNodes)
}</script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>








<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 600px;
                 background-color: #ffffff;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }






        </style>
    </head>


    <body>
        <div class="card" style="width: 100%">


            <div id="mynetwork" class="card-body"></div>
        </div>




        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };





              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');



                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"color": "#fde725", "font": {}, "id": "get_figure", "label": "get_figure", "level": 5.0, "mass": 2, "shape": "circle", "size": 10, "title": "Node class: get_figure\nGet a figure object.\n............................................\nargs = ()\nkwargs = {}\nbackend = Linked( a_cool_plot.backend )\nplot_actions = Linked( ListNode.output )\n"}, {"color": "pink", "font": {"color": "black"}, "id": "output", "label": "Output", "level": 6.0, "mass": 2, "shape": "box", "size": 10, "title": "Node class: WorkflowOutput\nNo documentation\n............................................\nvalue = Linked( get_figure.output )\n"}, {"color": "#ccc", "font": {"color": "black"}, "id": "color", "label": "Input(color)", "level": 1.0, "mass": 2, "shape": "box", "size": 10, "title": "Node class: WorkflowInput\nNo documentation\n............................................\nvalue = red\ninput_key = color\n"}, {"color": "#440154", "font": {"color": "white"}, "id": "DictNode", "label": "DictNode", "level": 2.0, "mass": 2, "shape": "circle", "size": 10, "title": "Node class: DictNode\nNo documentation\n............................................\nitems = {\u0027color\u0027: \u0027Linked( a_cool_plot.color )\u0027}\n"}, {"color": "#31688e", "font": {"color": "white"}, "id": "draw_line", "label": "draw_line", "level": 3.0, "mass": 2, "shape": "circle", "size": 10, "title": "Node class: draw_line\nDraws a line satisfying the specifications\n............................................\nname = None\nline = Linked( DictNode.output )\nmarker = {}\ntext = None\nrow = None\ncol = None\nkwargs = {}\nx = [1, 2]\ny = [3, 4]\n"}, {"color": "#35b779", "font": {}, "id": "ListNode", "label": "ListNode", "level": 4.0, "mass": 2, "shape": "circle", "size": 10, "title": "Node class: ListNode\nNo documentation\n............................................\nitems = (\u0027Linked( draw_line.output )\u0027,)\n"}, {"color": "#ccc", "font": {"color": "black"}, "id": "backend", "label": "Input(backend)", "level": 4.0, "mass": 2, "shape": "box", "size": 10, "title": "Node class: WorkflowInput\nNo documentation\n............................................\nvalue = plotly\ninput_key = backend\n"}]);
                  edges = new vis.DataSet([{"arrows": "to", "from": "get_figure", "label": "value", "title": "get_figure() -\u003e WorkflowOutput.value", "to": "output", "width": 1}, {"arrows": "to", "from": "color", "label": "items[color]", "title": "WorkflowInput() -\u003e DictNode.items[color]", "to": "DictNode", "width": 1}, {"arrows": "to", "from": "DictNode", "label": "line", "title": "DictNode() -\u003e draw_line.line", "to": "draw_line", "width": 1}, {"arrows": "to", "from": "draw_line", "label": "items[0]", "title": "draw_line() -\u003e ListNode.items[0]", "to": "ListNode", "width": 1}, {"arrows": "to", "from": "ListNode", "label": "plot_actions", "title": "ListNode() -\u003e get_figure.plot_actions", "to": "get_figure", "width": 1}, {"arrows": "to", "from": "backend", "label": "backend", "title": "WorkflowInput() -\u003e get_figure.backend", "to": "get_figure", "width": 1}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {
    "configure": {
        "enabled": false
    },
    "edges": {
        "color": {
            "inherit": true
        },
        "smooth": {
            "enabled": true,
            "type": "dynamic"
        }
    },
    "interaction": {
        "dragNodes": true,
        "hideEdgesOnDrag": false,
        "hideNodesOnDrag": false
    },
    "layout": {
        "hierarchical": {
            "blockShifting": true,
            "edgeMinimization": true,
            "enabled": true,
            "levelSeparation": 150,
            "parentCentralization": true,
            "sortMethod": "hubsize",
            "treeSpacing": 200
        },
        "improvedLayout": true,
        "randomSeed": 0
    },
    "physics": {
        "enabled": true,
        "stabilization": {
            "enabled": true,
            "fit": true,
            "iterations": 1000,
            "onlyDynamicEdges": false,
            "updateInterval": 50
        }
    }
};






                  network = new vis.Network(container, data, options);










                  return network;

              }
              drawGraph();
        </script>
    </body>
</html></div></div>
</div>
<p>There we go, our first multi-backend, updatable <code class="docutils literal notranslate"><span class="pre">Plot</span></code> :)</p>
<p>Let’s use it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">CoolPlot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plot</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-3) nodify.node.139753499365920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499365632:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499364864:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499364576:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499368656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499367072:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499368800:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_9.html"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
<p>And now, the moment we’ve all been waiting for. Let’s update our plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">update_inputs</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-3) nodify.node.139753499365920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499365632:node.py:get()- No need to evaluate
INFO    Task(Task-3) nodify.node.139753499364864:node.py:get()- No need to evaluate
INFO    Task(Task-3) nodify.node.139753499364576:node.py:get()- No need to evaluate
INFO    Task(Task-3) nodify.node.139753499368656:node.py:get()- No need to evaluate
INFO    Task(Task-3) nodify.node.139753499367072:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753499368800:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;__main__.a_cool_plot at 0x7f1ae5af9670&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/visualization_diy_Building_a_new_plot_20_2.png" src="../../_images/visualization_diy_Building_a_new_plot_20_2.png" />
</div>
</div>
</section>
<section id="Additional-methods">
<h1>Additional methods<a class="headerlink" href="#Additional-methods" title="Link to this heading"></a></h1>
<p>It might be useful sometimes to provide helper methods so that the users can interact quickly with your plot. E.g. to change inputs or to extract some information from it.</p>
<p>In that case, you’ll just have to define the plot class with <code class="docutils literal notranslate"><span class="pre">class</span></code> syntax and write the methods as you always do:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CoolPlot</span><span class="p">(</span><span class="n">Plot</span><span class="p">):</span>
    <span class="c1"># The function that this workflow will execute</span>
    <span class="n">function</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">a_cool_plot</span><span class="p">)</span>

    <span class="c1"># Additional methods.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">color_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uses the latest AI to change the color of the plot matching a given object&quot;&quot;&quot;</span>

        <span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">object</span> <span class="o">==</span> <span class="s2">&quot;sun&quot;</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span>
        <span class="k">elif</span> <span class="nb">object</span> <span class="o">==</span> <span class="s2">&quot;grass&quot;</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The AI could not determine the color of </span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_inputs</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And then you just use it as you would expect:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">CoolPlot</span><span class="p">()</span>
<span class="n">plot</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-3) nodify.node.139753497768784:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497767248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497971648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497969392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497969872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497974768:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497969728:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_12.html"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">color_like</span><span class="p">(</span><span class="s2">&quot;grass&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-3) nodify.node.139753497768784:node.py:get()- No need to evaluate
INFO    Task(Task-3) nodify.node.139753497767248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497971648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497969392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497969872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497974768:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-3) nodify.node.139753497969728:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/visualization_diy_Building_a_new_plot_26_1.png" src="../../_images/visualization_diy_Building_a_new_plot_26_1.png" />
</div>
</div>
</section>
<section id="Complex-plots">
<h1>Complex plots<a class="headerlink" href="#Complex-plots" title="Link to this heading"></a></h1>
<p>As you probably have noticed, you can go as complex as you wish inside your plot function. If you want to convert it to a <code class="docutils literal notranslate"><span class="pre">Plot</span></code> however, it is important that you encapsulate sub-functionalities into separate functions so that the workflow doesn’t become to complex, storing useless data and adding too much overhead (this is generic advice for <code class="docutils literal notranslate"><span class="pre">Workflow</span></code>s).</p>
<p>In <code class="docutils literal notranslate"><span class="pre">sisl.viz</span></code>, you will find plenty of helper functions, specially in <code class="docutils literal notranslate"><span class="pre">sisl.viz.processors</span></code>, that you might benefit from. You might want to check the already implemented plots in <code class="docutils literal notranslate"><span class="pre">sisl.viz.plots</span></code> for inspiration.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../combining-plots/Intro%20to%20combining%20plots.html" class="btn btn-neutral float-left" title="Intro to combining plots" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Adding%20new%20backends.html" class="btn btn-neutral float-right" title="Adding new backends" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2025, sisl developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>