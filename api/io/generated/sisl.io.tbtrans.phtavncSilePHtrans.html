

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sisl.io.tbtrans.phtavncSilePHtrans &mdash; sisl</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom_styles.css?v=cafe85c1" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=9d09c2c4"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=7800a641"></script>
      <script src="../../../_static/tabs.js?v=3ee01567"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="sisl.io.tbtrans.phtprojncSilePHtrans" href="sisl.io.tbtrans.phtprojncSilePHtrans.html" />
    <link rel="prev" title="sisl.io.tbtrans.phtsencSilePHtrans" href="sisl.io.tbtrans.phtsencSilePHtrans.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            sisl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cite.html">Citing sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualization/index.html">Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.viz</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/index.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../basic.html">Basic classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../geom/index.html">Geometry handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.geom</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../physics.html">Physical objects (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.physics</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mixing.html">Mixing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.mixing</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../viz/index.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../unit_constant.html">Units and constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utilities.html">Utilities (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.utils</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core.html">Functional programming</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Input/Output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.io</span></code>)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#the-sile-framework">The sile framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#i-o-from-buffers-and-zip-files">I/O from buffers and zip files</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#list-of-available-siles">List of available siles</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../generic.html">Generic files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bigdft.html">BigDFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dftb.html">DFTB+</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fhiaims.html">FHIaims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gulp.html">GULP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../openmx.html">OpenMX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orca.html">ORCA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scaleup.html">ScaleUP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../siesta.html">Siesta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../siesta.html#transiesta">TranSiesta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tbtrans.html">TBtrans</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../tbtrans.html#phtrans">PHtrans</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vasp.html">VASP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../wannier90.html">Wannier90</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../typing.html">Typing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.typing</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../environment.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../toolbox/index.html">Toolboxes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/index.html">Contributing to sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../math.html">Mathematical notation convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other.html">Related software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">API reference</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Input/Output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.io</span></code>)</a></li>
          <li class="breadcrumb-item"><a href="../tbtrans.html">TBtrans</a></li>
      <li class="breadcrumb-item active">sisl.io.tbtrans.phtavncSilePHtrans</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/api/io/generated/sisl.io.tbtrans.phtavncSilePHtrans.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sisl-io-tbtrans-phtavncsilephtrans">
<h1>sisl.io.tbtrans.phtavncSilePHtrans<a class="headerlink" href="#sisl-io-tbtrans-phtavncsilephtrans" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sisl.io.tbtrans.</span></span><span class="sig-name descname"><span class="pre">phtavncSilePHtrans</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="sisl.io.tbtrans.tbtavncSileTBtrans.html#sisl.io.tbtrans.tbtavncSileTBtrans" title="sisl.io.tbtrans.tbtavncSileTBtrans"><code class="xref py py-class docutils literal notranslate"><span class="pre">tbtavncSileTBtrans</span></code></a></p>
<p>PHtrans file object</p>
<p class="rubric">Plotting</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.plot" title="sisl.io.tbtrans.phtavncSilePHtrans.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a></p></td>
<td><p>Plotting functions for the <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans" title="sisl.io.tbtrans.phtavncSilePHtrans"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phtavncSilePHtrans</span></code></a> class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.plot.geometry" title="sisl.io.tbtrans.phtavncSilePHtrans.plot.geometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot.geometry</span></code></a>(*args[, ...])</p></td>
<td><p>Calls <code class="docutils literal notranslate"><span class="pre">read_geometry</span></code> and creates a <code class="docutils literal notranslate"><span class="pre">GeometryPlot</span></code> from its output.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.plot.pdos" title="sisl.io.tbtrans.phtavncSilePHtrans.plot.pdos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot.pdos</span></code></a>([geometry, ...])</p></td>
<td><p>Creates a <code class="docutils literal notranslate"><span class="pre">PDOSData</span></code> object and then plots a <code class="docutils literal notranslate"><span class="pre">PdosPlot</span></code> from it.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.ADOS" title="sisl.io.tbtrans.phtavncSilePHtrans.ADOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ADOS</span></code></a>([elec, E, kavg, atoms, orbitals, sum, norm])</p></td>
<td><p>Spectral density of states (DOS) (1/eV).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.Adensity_matrix" title="sisl.io.tbtrans.phtavncSilePHtrans.Adensity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Adensity_matrix</span></code></a>(elec, E[, kavg, isc, ...])</p></td>
<td><p>Spectral function density matrix at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> (1/eV)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.BDOS" title="sisl.io.tbtrans.phtavncSilePHtrans.BDOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BDOS</span></code></a>([elec, E, kavg, sum, norm])</p></td>
<td><p>Bulk density of states (DOS) (1/eV).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.DOS" title="sisl.io.tbtrans.phtavncSilePHtrans.DOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DOS</span></code></a>([E, kavg, atoms, orbitals, sum, norm])</p></td>
<td><p>Green function density of states (DOS) (1/eV).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.Eindex" title="sisl.io.tbtrans.phtavncSilePHtrans.Eindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Eindex</span></code></a>(E[, method])</p></td>
<td><p>Return the closest energy index corresponding to the energy <code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.a2p" title="sisl.io.tbtrans.phtavncSilePHtrans.a2p"><code class="xref py py-obj docutils literal notranslate"><span class="pre">a2p</span></code></a>(atoms)</p></td>
<td><p>Return the pivoting orbital indices (0-based) for the atoms, possibly on an electrode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_down" title="sisl.io.tbtrans.phtavncSilePHtrans.a_down"><code class="xref py py-obj docutils literal notranslate"><span class="pre">a_down</span></code></a>(elec)</p></td>
<td><p>Down-folding atomic indices for a given electrode</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_elec" title="sisl.io.tbtrans.phtavncSilePHtrans.a_elec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">a_elec</span></code></a>(elec)</p></td>
<td><p>Electrode atomic indices for the full geometry (sorted)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a>(E[, elec, kavg, isc, orbitals, uc])</p></td>
<td><p>Atomic COHP curve of the spectral function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a>(E[, elec, kavg, isc, orbitals, uc])</p></td>
<td><p>Atomic COOP curve of the spectral function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a>(E[, kavg, isc, orbitals, uc])</p></td>
<td><p>Atomic COHP curve of the Green function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a>(E[, kavg, isc, orbitals, uc])</p></td>
<td><p>Atomic COOP curve of the Green function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_current" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_current</span></code></a>([elec, elec_other, activity, ...])</p></td>
<td><p>Atomic current of atoms, a scalar quantity quantifying how much currents flows through an atom</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_transmission</span></code></a>(E[, elec, activity, kavg, ...])</p></td>
<td><p>Atomic transmission at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> of atoms, a scalar quantity quantifying how much transmission flows through an atom</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.base_directory" title="sisl.io.tbtrans.phtavncSilePHtrans.base_directory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_directory</span></code></a>([relative_to])</p></td>
<td><p>Retrieve the base directory of the file, relative to the path <em class="xref py py-obj">relative_to</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bloch" title="sisl.io.tbtrans.phtavncSilePHtrans.bloch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bloch</span></code></a>(elec)</p></td>
<td><p>Bloch-expansion coefficients for an electrode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_transmission</span></code></a>(E[, elec, kavg, isc, ...])</p></td>
<td><p>Bond transmission between atoms at a specific energy</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.btd" title="sisl.io.tbtrans.phtavncSilePHtrans.btd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">btd</span></code></a>([elec])</p></td>
<td><p>Block-sizes for the BTD method in the device/electrode region</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.close" title="sisl.io.tbtrans.phtavncSilePHtrans.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.density_matrix" title="sisl.io.tbtrans.phtavncSilePHtrans.density_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">density_matrix</span></code></a>(E[, kavg, isc, orbitals, ...])</p></td>
<td><p>Density matrix from the Green function at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> (1/eV)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.dir_file" title="sisl.io.tbtrans.phtavncSilePHtrans.dir_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dir_file</span></code></a>([filename, filename_base])</p></td>
<td><p>File of the current <em class="xref py py-obj">Sile</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.eta" title="sisl.io.tbtrans.phtavncSilePHtrans.eta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eta</span></code></a>([elec])</p></td>
<td><p>The imaginary part used when calculating the self-energies in eV (or for the device</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.info" title="sisl.io.tbtrans.phtavncSilePHtrans.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a>([elec])</p></td>
<td><p>Information about the calculated quantities available for extracting in this file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.iter" title="sisl.io.tbtrans.phtavncSilePHtrans.iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter</span></code></a>([group, dimension, variable, levels, root])</p></td>
<td><p>Iterator on all groups, variables and dimensions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.kindex" title="sisl.io.tbtrans.phtavncSilePHtrans.kindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kindex</span></code></a>(k)</p></td>
<td><p>Return the index of the k-point that is closests to the queried k-point (in reduced coordinates)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.mu" title="sisl.io.tbtrans.phtavncSilePHtrans.mu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mu</span></code></a>(elec)</p></td>
<td><p>Return the chemical potential associated with the electrode <em class="xref py py-obj">elec</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.n_btd" title="sisl.io.tbtrans.phtavncSilePHtrans.n_btd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_btd</span></code></a>([elec])</p></td>
<td><p>Number of blocks in the BTD partioning</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_down" title="sisl.io.tbtrans.phtavncSilePHtrans.na_down"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na_down</span></code></a>(elec)</p></td>
<td><p>Number of atoms the electrode occupies in the downfolded device region</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_down" title="sisl.io.tbtrans.phtavncSilePHtrans.no_down"><code class="xref py py-obj docutils literal notranslate"><span class="pre">no_down</span></code></a>(elec)</p></td>
<td><p>Number of orbitals in the downfolding region (including device downfolded region)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_e" title="sisl.io.tbtrans.phtavncSilePHtrans.no_e"><code class="xref py py-obj docutils literal notranslate"><span class="pre">no_e</span></code></a>(elec)</p></td>
<td><p>Number of orbitals the electrode occupies in the downfolded device region</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a>([atoms, orbitals, norm])</p></td>
<td><p>Normalization factor depending on the input</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.o2p" title="sisl.io.tbtrans.phtavncSilePHtrans.o2p"><code class="xref py py-obj docutils literal notranslate"><span class="pre">o2p</span></code></a>(orbitals[, elec])</p></td>
<td><p>Return the pivoting indices (0-based) for the orbitals, possibly on an electrode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a>(E[, elec, kavg, isc, orbitals])</p></td>
<td><p>Orbital resolved COHP analysis of the spectral function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a>(E[, elec, kavg, isc, orbitals])</p></td>
<td><p>Orbital COOP analysis of the spectral function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a>(E[, kavg, isc, orbitals])</p></td>
<td><p>Orbital resolved COHP analysis of the Green function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a>(E[, kavg, isc, orbitals])</p></td>
<td><p>Orbital COOP analysis of the Green function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a>(E[, elec, kavg, isc, ...])</p></td>
<td><p>Transmission at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> between orbitals originating from <em class="xref py py-obj">elec</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.phonon_temperature" title="sisl.io.tbtrans.phtavncSilePHtrans.phonon_temperature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phonon_temperature</span></code></a>(elec)</p></td>
<td><p>Phonon bath temperature [Kelvin]</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot" title="sisl.io.tbtrans.phtavncSilePHtrans.pivot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pivot</span></code></a>([elec, in_device, sort])</p></td>
<td><p>Return the pivoting indices for a specific electrode (in the device region) or the device</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot_down" title="sisl.io.tbtrans.phtavncSilePHtrans.pivot_down"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pivot_down</span></code></a>(elec[, in_down])</p></td>
<td><p>Pivoting orbitals for the downfolding region of a given electrode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.read" title="sisl.io.tbtrans.phtavncSilePHtrans.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(*args, **kwargs)</p></td>
<td><p>Generic read method which should be overloaded in child-classes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_brillouinzone" title="sisl.io.tbtrans.phtavncSilePHtrans.read_brillouinzone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_brillouinzone</span></code></a>()</p></td>
<td><p>Returns a <em class="xref py py-obj">BrillouinZone</em> object with the k-points associated</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_data" title="sisl.io.tbtrans.phtavncSilePHtrans.read_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_data</span></code></a>(*args, **kwargs)</p></td>
<td><p>Read specific type of data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_geometry" title="sisl.io.tbtrans.phtavncSilePHtrans.read_geometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_geometry</span></code></a>(*args, **kwargs)</p></td>
<td><p>Returns <em class="xref py py-obj">Geometry</em> object from this file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_lattice" title="sisl.io.tbtrans.phtavncSilePHtrans.read_lattice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_lattice</span></code></a>()</p></td>
<td><p>Returns <em class="xref py py-obj">Lattice</em> object from this file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.reflection" title="sisl.io.tbtrans.phtavncSilePHtrans.reflection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reflection</span></code></a>([elec, kavg, from_single])</p></td>
<td><p>Reflection into electrode <em class="xref py py-obj">elec</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_atom_to_vector" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_atom_to_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_atom_to_vector</span></code></a>(Dab)</p></td>
<td><p>Reduce an atomic sparse matrix to a vector contribution of each atom</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_orbital_to_atom</span></code></a>(Dij[, uc, sum_dup])</p></td>
<td><p>Reduce a sparse matrix in orbital sparse to a sparse matrix in atomic indices</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_scalar" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_scalar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_orbital_to_scalar</span></code></a>(Dij[, activity])</p></td>
<td><p>Atomic scalar contribution of atoms for a sparse orbital matrix</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_vector" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_orbital_to_vector</span></code></a>(Dij[, uc, sum_dup])</p></td>
<td><p>Reduce an orbital sparse matrix to a vector contribution of each atom</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission</span></code></a>([elec_from, elec_to, kavg])</p></td>
<td><p>Transmission from <em class="xref py py-obj">elec_from</em> to <em class="xref py py-obj">elec_to</em>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_bulk</span></code></a>([elec, kavg])</p></td>
<td><p>Bulk transmission for the <em class="xref py py-obj">elec</em> electrode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_eig</span></code></a>([elec_from, elec_to, kavg])</p></td>
<td><p>Transmission eigenvalues from <em class="xref py py-obj">elec_from</em> to <em class="xref py py-obj">elec_to</em>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_transmission</span></code></a>(E[, elec, kavg, isc, ...])</p></td>
<td><p>Vector for each atom being the sum of bond transmissions times the normalized bond vector between the atoms</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.write" title="sisl.io.tbtrans.phtavncSilePHtrans.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(*args, **kwargs)</p></td>
<td><p>Generic write method which should be overloaded in child-classes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.write_tbtav" title="sisl.io.tbtrans.phtavncSilePHtrans.write_tbtav"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_tbtav</span></code></a>(*args, **kwargs)</p></td>
<td><p>Wrapper for writing the k-averaged TBT.AV.nc file.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a></p></td>
<td><p>Sampled energy-points in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_buf" title="sisl.io.tbtrans.phtavncSilePHtrans.a_buf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">a_buf</span></code></a></p></td>
<td><p>Atomic indices (0-based) of device atoms</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_dev" title="sisl.io.tbtrans.phtavncSilePHtrans.a_dev"><code class="xref py py-obj docutils literal notranslate"><span class="pre">a_dev</span></code></a></p></td>
<td><p>Atomic indices (0-based) of device atoms (sorted)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.base_file" title="sisl.io.tbtrans.phtavncSilePHtrans.base_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_file</span></code></a></p></td>
<td><p>File of the current <em class="xref py py-obj">Sile</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_current</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.cell" title="sisl.io.tbtrans.phtavncSilePHtrans.cell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell</span></code></a></p></td>
<td><p>Unit cell in file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.chemical_potential" title="sisl.io.tbtrans.phtavncSilePHtrans.chemical_potential"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chemical_potential</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.current" title="sisl.io.tbtrans.phtavncSilePHtrans.current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">current</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.current_parameter" title="sisl.io.tbtrans.phtavncSilePHtrans.current_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_parameter</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.elecs" title="sisl.io.tbtrans.phtavncSilePHtrans.elecs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">elecs</span></code></a></p></td>
<td><p>List of electrodes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.electron_temperature" title="sisl.io.tbtrans.phtavncSilePHtrans.electron_temperature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">electron_temperature</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.fano" title="sisl.io.tbtrans.phtavncSilePHtrans.fano"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fano</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.file" title="sisl.io.tbtrans.phtavncSilePHtrans.file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">file</span></code></a></p></td>
<td><p>File of the current <em class="xref py py-obj">Sile</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.geometry" title="sisl.io.tbtrans.phtavncSilePHtrans.geometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">geometry</span></code></a></p></td>
<td><p>The associated geometry from this file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.k" title="sisl.io.tbtrans.phtavncSilePHtrans.k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k</span></code></a></p></td>
<td><p>Sampled k-points in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.kT" title="sisl.io.tbtrans.phtavncSilePHtrans.kT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kT</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.kpt" title="sisl.io.tbtrans.phtavncSilePHtrans.kpt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kpt</span></code></a></p></td>
<td><p>Sampled k-points in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.lasto" title="sisl.io.tbtrans.phtavncSilePHtrans.lasto"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lasto</span></code></a></p></td>
<td><p>Last orbital of corresponding atom</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.nE" title="sisl.io.tbtrans.phtavncSilePHtrans.nE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nE</span></code></a></p></td>
<td><p>Number of energy-points in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na" title="sisl.io.tbtrans.phtavncSilePHtrans.na"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na</span></code></a></p></td>
<td><p>Returns number of atoms in the cell</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_b" title="sisl.io.tbtrans.phtavncSilePHtrans.na_b"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na_b</span></code></a></p></td>
<td><p>Number of atoms in the buffer region</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_buffer" title="sisl.io.tbtrans.phtavncSilePHtrans.na_buffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na_buffer</span></code></a></p></td>
<td><p>Number of atoms in the buffer region</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_d" title="sisl.io.tbtrans.phtavncSilePHtrans.na_d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na_d</span></code></a></p></td>
<td><p>Number of atoms in the device region</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_dev" title="sisl.io.tbtrans.phtavncSilePHtrans.na_dev"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na_dev</span></code></a></p></td>
<td><p>Number of atoms in the device region</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_u" title="sisl.io.tbtrans.phtavncSilePHtrans.na_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">na_u</span></code></a></p></td>
<td><p>Returns number of atoms in the cell</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.ne" title="sisl.io.tbtrans.phtavncSilePHtrans.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ne</span></code></a></p></td>
<td><p>Number of energy-points in file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.nk" title="sisl.io.tbtrans.phtavncSilePHtrans.nk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nk</span></code></a></p></td>
<td><p>Number of k-points in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.nkpt" title="sisl.io.tbtrans.phtavncSilePHtrans.nkpt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nkpt</span></code></a></p></td>
<td><p>Always return 1, this is to signal other routines</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.no" title="sisl.io.tbtrans.phtavncSilePHtrans.no"><code class="xref py py-obj docutils literal notranslate"><span class="pre">no</span></code></a></p></td>
<td><p>Returns number of orbitals in the cell</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_d" title="sisl.io.tbtrans.phtavncSilePHtrans.no_d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">no_d</span></code></a></p></td>
<td><p>Number of orbitals in the device region</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_u" title="sisl.io.tbtrans.phtavncSilePHtrans.no_u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">no_u</span></code></a></p></td>
<td><p>Returns number of orbitals in the cell</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.noise_power" title="sisl.io.tbtrans.phtavncSilePHtrans.noise_power"><code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_power</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.o_dev" title="sisl.io.tbtrans.phtavncSilePHtrans.o_dev"><code class="xref py py-obj docutils literal notranslate"><span class="pre">o_dev</span></code></a></p></td>
<td><p>Orbital indices (0-based) of device orbitals (sorted)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_current</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.shot_noise" title="sisl.io.tbtrans.phtavncSilePHtrans.shot_noise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shot_noise</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_current</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.wk" title="sisl.io.tbtrans.phtavncSilePHtrans.wk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wk</span></code></a></p></td>
<td><p>Weights of k-points in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.wkpt" title="sisl.io.tbtrans.phtavncSilePHtrans.wkpt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wkpt</span></code></a></p></td>
<td><p>Always return [1.], this is to signal other routines</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.xa" title="sisl.io.tbtrans.phtavncSilePHtrans.xa"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xa</span></code></a></p></td>
<td><p>Atomic coordinates in file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.xyz" title="sisl.io.tbtrans.phtavncSilePHtrans.xyz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xyz</span></code></a></p></td>
<td><p>Atomic coordinates in file</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.ADOS">
<span class="sig-name descname"><span class="pre">ADOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.ADOS" title="Link to this definition"></a></dt>
<dd><p>Spectral density of states (DOS) (1/eV).</p>
<p>Extract the spectral DOS from electrode <em class="xref py py-obj">elec</em> on a selected subset of atoms/orbitals in the device region</p>
<div class="math notranslate nohighlight">
\[\mathrm{ADOS}_\mathfrak{el}(E) = \frac{1}{2\pi N} \sum_{i\in\{I\}} [\mathbf{G}(E)\Gamma_\mathfrak{el}\mathbf{G}^\dagger]_{ii}(E)\]</div>
<p>The normalization constant (<span class="math notranslate nohighlight">\(N\)</span>) is defined in the routine <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> and depends on the
arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – electrode originating spectral function</p></li>
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – optionally only return the DOS of atoms at a given energy point</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned DOS is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>atoms</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – only return for a given set of atoms (default to all).
<em>NOT</em> allowed with <em class="xref py py-obj">orbitals</em> keyword. If <em class="xref py py-obj">True</em> it will use all atoms in the device.
False is equivalent to None.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – only return for a given set of orbitals (default to all)
<em>NOT</em> allowed with <em class="xref py py-obj">atoms</em> keyword. If <em class="xref py py-obj">True</em> it will use all orbitals in the device.
False is equivalent to None.</p></li>
<li><p><strong>sum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned quantities are summed or returned <em>as is</em>, i.e. resolved per atom/orbital.</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'none'</em><em>, </em><em>'atom'</em><em>, </em><em>'orbital'</em><em>, </em><em>'all'</em><em>]</em>) – how the normalization of the summed DOS is performed (see <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> routine).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.DOS" title="sisl.io.tbtrans.phtavncSilePHtrans.DOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DOS</span></code></a></dt><dd><p>the total density of states (including bound states)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.BDOS" title="sisl.io.tbtrans.phtavncSilePHtrans.BDOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BDOS</span></code></a></dt><dd><p>the bulk density of states in an electrode</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.Adensity_matrix">
<span class="sig-name descname"><span class="pre">Adensity_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.Adensity_matrix" title="Link to this definition"></a></dt>
<dd><p>Spectral function density matrix at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> (1/eV)</p>
<p>The density matrix can be used to calculate the LDOS in real-space.</p>
<p>The <span class="math notranslate nohighlight">\(\mathrm{LDOS}(E, \mathbf r)\)</span> may be calculated using the <a class="reference internal" href="../../generated/sisl.physics.DensityMatrix.html#sisl.physics.DensityMatrix.density" title="sisl.physics.DensityMatrix.density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">density</span></code></a>
routine. Basically the LDOS in real-space may be calculated as</p>
<div class="math notranslate nohighlight">
\[\boldsymbol\rho_{\mathbf A_{\mathfrak{el}}}(E, \mathbf r) = \frac{1}{2\pi}\sum_{ij}\phi_i(\mathbf r)\phi_j(\mathbf r) \Re[\mathbf A_{\mathfrak{el}, ij}(E)]\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> are the orbitals. Note that the broadening used in the TBtrans calculations
ensures the broadening of the density, i.e. it should not be necessary to perform energy
averages over the density matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of originating electrons</p></li>
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the density matrix corresponding to the energy.</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned density matrix is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned density matrix from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all density matrix elements for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain density matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><em>Geometry</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – geometry that will be associated with the density matrix. By default the
geometry contained in this file will be used. However, then the
atomic species are probably incorrect, nor will the orbitals contain
the basis-set information required to generate the required density
in real-space.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.density_matrix" title="sisl.io.tbtrans.phtavncSilePHtrans.density_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">density_matrix</span></code></a></dt><dd><p>Green function density matrix</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>object containing the Geometry and the density matrix elements</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DensityMatrix</span></code></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>)</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><em>Geometry</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.BDOS">
<span class="sig-name descname"><span class="pre">BDOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.BDOS" title="Link to this definition"></a></dt>
<dd><p>Bulk density of states (DOS) (1/eV).</p>
<p>Extract the bulk DOS from electrode <em class="xref py py-obj">elec</em>.</p>
<div class="math notranslate nohighlight">
\[\mathrm{BDOS}_\mathfrak{el}(E) = -\frac{1}{\pi} \Im\mathbf{G}(E)\]</div>
<p>This returns the density of states for the full (Bloch-expanded) electrode.
When <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> is ‘none’, the DOS is the full DOS for all electrode atoms (fully expanded),
if you want to get the DOS for the minimal (un-expanded) electrode unit-cell,
then divide by <code class="docutils literal notranslate"><span class="pre">np.prod(tbt.bloch(elec))</span></code>.
When <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> is anything else, it will be normalised to the number of atoms/orbitals
in the electrode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – electrode where the bulk DOS is returned</p></li>
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – optionally only return the DOS of atoms at a given energy point</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned DOS is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>sum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned quantities are summed or returned <em>as is</em>, i.e. resolved per atom/orbital.</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'none'</em><em>, </em><em>'atom'</em><em>, </em><em>'orbital'</em><em>, </em><em>'all'</em><em>]</em>) – whether the returned quantities are summed over all orbitals or normed by number of orbitals in the electrode.
Currently one cannot extract DOS per atom/orbital.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.DOS" title="sisl.io.tbtrans.phtavncSilePHtrans.DOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DOS</span></code></a></dt><dd><p>the total density of states (including bound states)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.ADOS" title="sisl.io.tbtrans.phtavncSilePHtrans.ADOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ADOS</span></code></a></dt><dd><p>the spectral density of states from an electrode</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.DOS">
<span class="sig-name descname"><span class="pre">DOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.DOS" title="Link to this definition"></a></dt>
<dd><p>Green function density of states (DOS) (1/eV).</p>
<p>Extract the DOS on a selected subset of atoms/orbitals in the device region</p>
<div class="math notranslate nohighlight">
\[\mathrm{DOS}(E) = -\frac{1}{\pi N} \sum_{i\in \{I\}} \Im \mathbf{G}_{ii}(E)\]</div>
<p>The normalization constant (<span class="math notranslate nohighlight">\(N\)</span>) is defined in the routine <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> and depends on the
arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – optionally only return the DOS of atoms at a given energy point</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned DOS is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>atoms</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – only return for a given set of atoms (default to all).
<em>NOT</em> allowed with <em class="xref py py-obj">orbitals</em> keyword. If <em class="xref py py-obj">True</em> it will use all atoms in the device.
False is equivalent to None.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – only return for a given set of orbitals (default to all)
<em>NOT</em> allowed with <em class="xref py py-obj">atoms</em> keyword. If <em class="xref py py-obj">True</em> it will use all orbitals in the device.
False is equivalent to None.</p></li>
<li><p><strong>sum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned quantities are summed or returned <em>as is</em>, i.e. resolved per atom/orbital.</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'none'</em><em>, </em><em>'atom'</em><em>, </em><em>'orbital'</em><em>, </em><em>'all'</em><em>]</em>) – how the normalization of the summed DOS is performed (see <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> routine)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.ADOS" title="sisl.io.tbtrans.phtavncSilePHtrans.ADOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ADOS</span></code></a></dt><dd><p>the spectral density of states from an electrode</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.BDOS" title="sisl.io.tbtrans.phtavncSilePHtrans.BDOS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BDOS</span></code></a></dt><dd><p>the bulk density of states in an electrode</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.Eindex">
<span class="sig-name descname"><span class="pre">Eindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.Eindex" title="Link to this definition"></a></dt>
<dd><p>Return the closest energy index corresponding to the energy <code class="docutils literal notranslate"><span class="pre">E</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>Etype</em>) – return the energy index which is
closest to the energy passed.
For a <em class="xref py py-obj">str</em> it will be parsed to a float and treated as such.</p></li>
<li><p><strong>method</strong> (<em>Literal</em><em>[</em><em>'nearest'</em><em>, </em><em>'above'</em><em>, </em><em>'below'</em><em>]</em>) – how non-equal values should be located.
* <em class="xref py py-obj">nearest</em> takes the closest value
* <em class="xref py py-obj">above</em> takes the closest value above <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a>.
* <em class="xref py py-obj">below</em> takes the closest value below <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.a2p">
<span class="sig-name descname"><span class="pre">a2p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.a2p" title="Link to this definition"></a></dt>
<dd><p>Return the pivoting orbital indices (0-based) for the atoms, possibly on an electrode</p>
<p>This is equivalent to:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o2p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">a2o</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>Will warn if an atom requested is not in the device list of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atoms</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – atomic indices (0-based)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.a_down">
<span class="sig-name descname"><span class="pre">a_down</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_down" title="Link to this definition"></a></dt>
<dd><p>Down-folding atomic indices for a given electrode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – electrode to retrieve indices for</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.a_elec">
<span class="sig-name descname"><span class="pre">a_elec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_elec" title="Link to this definition"></a></dt>
<dd><p>Electrode atomic indices for the full geometry (sorted)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – electrode to retrieve indices for</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP">
<span class="sig-name descname"><span class="pre">atom_ACOHP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="Link to this definition"></a></dt>
<dd><p>Atomic COHP curve of the spectral function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the atomic COHP corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of the spectral function</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COHP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COHP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COHP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COHP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COHP are only in the unit-cell.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP">
<span class="sig-name descname"><span class="pre">atom_ACOOP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="Link to this definition"></a></dt>
<dd><p>Atomic COOP curve of the spectral function</p>
<p>The atomic COOP are a sum over all orbital COOP:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COOP}_{IJ} = \sum_{i\in I}\sum_{j\in J} \mathrm{COOP}_{ij}\]</div>
<p>This is a shorthand for calling <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a> and <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_orbital_to_atom</span></code></a> in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the atomic COOP corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of the spectral function</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COOP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COOP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COOP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COOP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COOP are only in the unit-cell.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP">
<span class="sig-name descname"><span class="pre">atom_COHP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="Link to this definition"></a></dt>
<dd><p>Atomic COHP curve of the Green function</p>
<p>The atomic COHP are a sum over all orbital COHP:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COHP}_{IJ} = \sum_{i\in I}\sum_{j\in J} \mathrm{COHP}_{ij}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the atomic COHP corresponding to the energy.</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COHP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COHP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COHP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COHP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COHP are only in the unit-cell.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP">
<span class="sig-name descname"><span class="pre">atom_COOP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="Link to this definition"></a></dt>
<dd><p>Atomic COOP curve of the Green function</p>
<p>The atomic COOP are a sum over all orbital COOP:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COOP}_{IJ} = \sum_{i\in I}\sum_{j\in J} \mathrm{COOP}_{ij}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the atomic COOP corresponding to the energy.</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COOP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COOP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COOP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COOP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COOP are only in the unit-cell.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.atom_current">
<span class="sig-name descname"><span class="pre">atom_current</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_other</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_current" title="Link to this definition"></a></dt>
<dd><p>Atomic current of atoms, a scalar quantity quantifying how much currents flows through an atom</p>
<p>The atomic current is a single number specifying a figure of the <em>magnitude</em>
current flowing through each atom. It is thus <em>not</em> a quantity that can be related to
the physical current flowing in/out of atoms but is merely a number that provides an
idea of <em>how much</em> current this atom is redistributing.</p>
<p>The atomic current may have two meanings based on these two equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf j_I^{|a|} &amp;=\frac 12 \sum_{\{J\}} \Big| \sum_{i\in I}\sum_{j\in J} \mathbf J_{ij} \Big|
\\
\mathbf j_I^{|o|} &amp;=\frac 12 \sum_{i\in I}\sum_{j\in\{J\}} \big| J_{ij} \big|\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\]</div>
<p>If the <em>activity</em> is requested (<code class="docutils literal notranslate"><span class="pre">activity=True</span></code>)
<span class="math notranslate nohighlight">\(\mathbf j_I^{\mathcal A} = \sqrt{\mathbf j_I^{|a|} \mathbf j_I^{|o|} }\)</span> is returned.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">activity=False</span></code> <span class="math notranslate nohighlight">\(\mathbf j_I^{|a|}\)</span> is returned.</p>
<p>For geometries with all atoms only having 1-orbital, they are equivalent.</p>
<p>Generally the activity current is a more rigorous figure of merit for the current
flowing through an atom. More so than than the summed absolute atomic current due to
the following reasoning. The activity current is a geometric mean of the absolute bond current
and the absolute orbital current. This means that if there is an atom with a large orbital current
it will have a larger activity current.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the originating electrode</p></li>
<li><p><strong>elec_other</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – this electrode determines the <em>other</em> chemical potential. As such the orbital currents
does not reflect the current going from <em class="xref py py-obj">elec</em> <em>to</em> <em class="xref py py-obj">elec_other</em>!</p></li>
<li><p><strong>activity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> to return the activity current, see explanation above</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned orbital current is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned bond currents from the unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all orbital currents for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain orbital currents for a subset of orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_current</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="c1"># orbital current originating from electrode ``0``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ja</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">sparse_orbital_to_scalar</span><span class="p">(</span><span class="n">Jij</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Calculating the current between two electrodes with the same
chemical potential will return a matrix filled with 0’s since there is
no bias window.</p>
<p>The currents does not reflect the current going from <em class="xref py py-obj">elec_from</em> <em>to</em> <em class="xref py py-obj">elec_other</em>!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a></dt><dd><p>energy resolved transmission between orbitals</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_current</span></code></a></dt><dd><p>bias window integrated transmissions</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_transmission</span></code></a></dt><dd><p>energy resolved transmissions between atoms</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_current</span></code></a></dt><dd><p>bias window integrated transmissions (orbital current summed over orbitals)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_transmission</span></code></a></dt><dd><p>an atomic field transmission for each atom (Cartesian representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_current</span></code></a></dt><dd><p>an atomic field current for each atom (Cartesian representation of bond-currents)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_transmission</span></code></a></dt><dd><p>energy resolved atomic transmission for each atom (scalar representation of bond-transmissions)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission">
<span class="sig-name descname"><span class="pre">atom_transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission" title="Link to this definition"></a></dt>
<dd><p>Atomic transmission at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> of atoms, a scalar quantity quantifying how much transmission flows through an atom</p>
<p>The atomic transmission is a single number specifying a figure of the <em>magnitude</em>
transmission flowing through each atom. It is thus <em>not</em> a quantity that can be related to
the physical transmission flowing in/out of atoms but is merely a number that provides an
idea of <em>how much</em> this atom is redistributing.</p>
<p>The atomic transmission may have two meanings based on these two equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_I^{|a|} &amp;=\frac 12 \sum_{\{J\}} \Big| \sum_{i\in I}\sum_{j\in J} \mathbf T_{ij} \Big|
\\
T_I^{|o|} &amp;=\frac 12 \sum_{i\in I}\sum_{j\in\{J\}} \big| T_{ij} \big|\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\]</div>
<p>If the <em>activity</em> is requested (<code class="docutils literal notranslate"><span class="pre">activity=True</span></code>)
<span class="math notranslate nohighlight">\(T_I^{\mathcal A} = \sqrt{T_I^{|a|} T_I^{|o|} }\)</span> is returned.
If the <em>activity</em> current is requested (<code class="docutils literal notranslate"><span class="pre">activity=True</span></code>)</p>
<p>If <code class="docutils literal notranslate"><span class="pre">activity=False</span></code> <span class="math notranslate nohighlight">\(T_I^{|a|}\)</span> is returned.</p>
<p>For geometries with all atoms only having 1-orbital, they are equivalent.</p>
<p>Generally the <em>activity</em> is a more rigorous figure of merit for the transmission
flowing through an atom. More so than than the summed absolute atomic transmission due to
the following reasoning. The activity transmission is a geometric mean of the absolute bond transmission
and the absolute orbital transmission. This means that if there is an atom with a large orbital transmission
it will have a larger activity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the atomic transmission corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the originating electrode</p></li>
<li><p><strong>activity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> to return the activity, see explanation above</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned atomic transmissions are k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned transmissions from the unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all orbital transmissions are used for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain orbital currents for a subset of orbitals.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_transmission</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">what</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="c1"># transmission @ E=-1 eV from electrode ``0``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ja</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">sparse_orbital_to_scalar</span><span class="p">(</span><span class="n">Jij</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a></dt><dd><p>energy resolved transmission between orbitals</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_current</span></code></a></dt><dd><p>bias window integrated transmissions</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_transmission</span></code></a></dt><dd><p>energy resolved transmissions between atoms</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_current</span></code></a></dt><dd><p>bias window integrated transmissions (orbital current summed over orbitals)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_transmission</span></code></a></dt><dd><p>an atomic field transmission for each atom (Cartesian representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_current</span></code></a></dt><dd><p>an atomic field current for each atom (Cartesian representation of bond-currents)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_current" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_current</span></code></a></dt><dd><p>the atomic current for each atom (scalar representation of bond-currents)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.base_directory">
<span class="sig-name descname"><span class="pre">base_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.base_directory" title="Link to this definition"></a></dt>
<dd><p>Retrieve the base directory of the file, relative to the path <em class="xref py py-obj">relative_to</em></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.bloch">
<span class="sig-name descname"><span class="pre">bloch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.bloch" title="Link to this definition"></a></dt>
<dd><p>Bloch-expansion coefficients for an electrode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – bloch expansions of electrode</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission">
<span class="sig-name descname"><span class="pre">bond_transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission" title="Link to this definition"></a></dt>
<dd><p>Bond transmission between atoms at a specific energy</p>
<p>Short hand function for calling <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a> and <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_orbital_to_atom</span></code></a>.</p>
<p>The bond transmissions are a sum over all orbital transmissions</p>
<div class="math notranslate nohighlight">
\[T_{IJ}(E) = \sum_{i\in I}\sum_{j\in J} T_{ij}(E)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the bond transmission corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of originating electrons</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned bond transmissions is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned transmissions from the unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) (default) to
the given supercell. If <code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code> is passed all transmissions are returned.</p></li>
<li><p><strong>what</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;all&quot;/&quot;both&quot;/&quot;+-&quot;/&quot;inout&quot;,</span> <span class="pre">&quot;+&quot;/&quot;out&quot;,</span> <span class="pre">&quot;-&quot;/&quot;in&quot;}</span></code>) – If +/out is supplied only the positive transmissions are used (going out)
for -/in, only the negative transmissions are used (going in),
else return both. Please see discussion in <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain transmissions for a subset of orbitals before calculating bond transmissions
Passed directly to <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a>.</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned transmissions are only in the unit-cell (supercell bonds will be folded to their unit-cell equivalents).
If <em class="xref py py-obj">True</em> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_transmission</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">)</span> <span class="c1"># orbital transmission @ E = -1 eV originating from electrode ``0``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jab1</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">sparse_orbital_to_atom</span><span class="p">(</span><span class="n">Jij</span><span class="p">)[</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jab2</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">bond_transmission</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jab1</span> <span class="o">==</span> <span class="n">Jab2</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a></dt><dd><p>energy resolved transmission between orbitals</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_current</span></code></a></dt><dd><p>bias window integrated transmissions</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_current</span></code></a></dt><dd><p>bias window integrated transmissions (orbital current summed over orbitals)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_transmission</span></code></a></dt><dd><p>an atomic field transmission for each atom (Cartesian representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_current</span></code></a></dt><dd><p>an atomic field current for each atom (Cartesian representation of bond-currents)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_transmission</span></code></a></dt><dd><p>energy resolved atomic transmission for each atom (scalar representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_current" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_current</span></code></a></dt><dd><p>the atomic current for each atom (scalar representation of bond-currents)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.btd">
<span class="sig-name descname"><span class="pre">btd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.btd" title="Link to this definition"></a></dt>
<dd><p>Block-sizes for the BTD method in the device/electrode region</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – the BTD block sizes for the device (if none), otherwise the downfolding
BTD block sizes for the electrode</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.close" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.density_matrix">
<span class="sig-name descname"><span class="pre">density_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.density_matrix" title="Link to this definition"></a></dt>
<dd><p>Density matrix from the Green function at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> (1/eV)</p>
<p>The density matrix can be used to calculate the LDOS in real-space.</p>
<p>The <span class="math notranslate nohighlight">\(\mathrm{LDOS}(E, \mathbf r)\)</span> may be calculated using the <a class="reference internal" href="../../generated/sisl.physics.DensityMatrix.html#sisl.physics.DensityMatrix.density" title="sisl.physics.DensityMatrix.density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">density</span></code></a>
routine. Basically the LDOS in real-space may be calculated as</p>
<div class="math notranslate nohighlight">
\[\boldsymbol\rho_{\mathbf G}(E, \mathbf r) = -\frac{1}{\pi}\sum_{ij}\phi_i(\mathbf r)\phi_j(\mathbf r) \Im[\mathbf G_{ij}(E)]\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> are the orbitals. Note that the broadening used in the TBtrans calculations
ensures the broadening of the density, i.e. it should not be necessary to perform energy
averages over the density matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the density matrix corresponding to the energy.</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned density matrix is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned density matrix from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all density matrix elements for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain density matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><em>Geometry</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – geometry that will be associated with the density matrix. By default the
geometry contained in this file will be used. However, then the
atomic species are probably incorrect, nor will the orbitals contain
the basis-set information required to generate the required density
in real-space.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.Adensity_matrix" title="sisl.io.tbtrans.phtavncSilePHtrans.Adensity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Adensity_matrix</span></code></a></dt><dd><p>spectral function density matrix</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>object containing the Geometry and the density matrix elements</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DensityMatrix</span></code></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>)</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><em>Geometry</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.dir_file">
<span class="sig-name descname"><span class="pre">dir_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.dir_file" title="Link to this definition"></a></dt>
<dd><p>File of the current <em class="xref py py-obj">Sile</em></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.eta">
<span class="sig-name descname"><span class="pre">eta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.eta" title="Link to this definition"></a></dt>
<dd><p>The imaginary part used when calculating the self-energies in eV (or for the device</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – electrode to extract the eta value from. If not specified (or None) the device
region eta will be returned.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.info" title="Link to this definition"></a></dt>
<dd><p>Information about the calculated quantities available for extracting in this file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – the electrode to request information from</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.iter">
<span class="sig-name descname"><span class="pre">iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.iter" title="Link to this definition"></a></dt>
<dd><p>Iterator on all groups, variables and dimensions.</p>
<p>This iterator iterates through all groups, variables and dimensions in the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>The generator sequence will _always_ be:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Group</p></li>
<li><p>Dimensions in group</p></li>
<li><p>Variables in group</p></li>
</ol>
</div></blockquote>
<p>As the dimensions are generated before the variables it is possible to copy
groups, dimensions, and then variables such that one always ensures correct
dependencies in the generation of a new <code class="docutils literal notranslate"><span class="pre">SileCDF</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code> (<em class="xref py py-obj">True</em>)) – whether the iterator yields <em class="xref py py-obj">Group</em> instances</p></li>
<li><p><strong>dimension</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code> (<em class="xref py py-obj">True</em>)) – whether the iterator yields <em class="xref py py-obj">Dimension</em> instances</p></li>
<li><p><strong>variable</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code> (<em class="xref py py-obj">True</em>)) – whether the iterator yields <em class="xref py py-obj">Variable</em> instances</p></li>
<li><p><strong>levels</strong> (<code class="docutils literal notranslate"><span class="pre">int</span></code> (<em class="xref py py-obj">-1</em>)) – number of levels to traverse, with respect to <code class="docutils literal notranslate"><span class="pre">root</span></code> variable, i.e. number of
sub-groups this iterator will return.</p></li>
<li><p><strong>root</strong> (<code class="docutils literal notranslate"><span class="pre">str</span></code> (<em class="xref py py-obj">None</em>)) – the base root to start iterating from.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Script for looping and checking each instance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">gv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isGroup</span><span class="p">(</span><span class="n">gv</span><span class="p">):</span>
<span class="gp">... </span>        <span class="c1"># is group</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isDimension</span><span class="p">(</span><span class="n">gv</span><span class="p">):</span>
<span class="gp">... </span>        <span class="c1"># is dimension</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">isVariable</span><span class="p">(</span><span class="n">gv</span><span class="p">):</span>
<span class="gp">... </span>        <span class="c1"># is variable</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.kindex">
<span class="sig-name descname"><span class="pre">kindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.kindex" title="Link to this definition"></a></dt>
<dd><p>Return the index of the k-point that is closests to the queried k-point (in reduced coordinates)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – the queried k-point in reduced coordinates <span class="math notranslate nohighlight">\(]-0.5;0.5]\)</span>. If <code class="docutils literal notranslate"><span class="pre">int</span></code>
return it-self.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.mu">
<span class="sig-name descname"><span class="pre">mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.mu" title="Link to this definition"></a></dt>
<dd><p>Return the chemical potential associated with the electrode <em class="xref py py-obj">elec</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.n_btd">
<span class="sig-name descname"><span class="pre">n_btd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.n_btd" title="Link to this definition"></a></dt>
<dd><p>Number of blocks in the BTD partioning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – if None the number of blocks in the device region BTD matrix. Else
the number of BTD blocks in the electrode down-folding.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na_down">
<span class="sig-name descname"><span class="pre">na_down</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_down" title="Link to this definition"></a></dt>
<dd><p>Number of atoms the electrode occupies in the downfolded device region</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of downfolding atoms for electrode <em class="xref py py-obj">elec</em></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.no_down">
<span class="sig-name descname"><span class="pre">no_down</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_down" title="Link to this definition"></a></dt>
<dd><p>Number of orbitals in the downfolding region (including device downfolded region)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of downfolding orbitals for electrode <em class="xref py py-obj">elec</em></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.no_e">
<span class="sig-name descname"><span class="pre">no_e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_e" title="Link to this definition"></a></dt>
<dd><p>Number of orbitals the electrode occupies in the downfolded device region</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Specify the electrode to query number of downfolded orbitals</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="Link to this definition"></a></dt>
<dd><p>Normalization factor depending on the input</p>
<p>The normalization can be performed in one of the below methods.
In the following <span class="math notranslate nohighlight">\(N\)</span> refers to the normalization constant
that is to be used (i.e. the divisor):</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'none'</span></code></dt><dd><p><span class="math notranslate nohighlight">\(N=1\)</span></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'all'</span></code></dt><dd><p><span class="math notranslate nohighlight">\(N\)</span> equals the number of orbitals in the total device region.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'atom'</span></code></dt><dd><p><span class="math notranslate nohighlight">\(N\)</span> equals the total number of orbitals in the selected
atoms. If <em class="xref py py-obj">orbitals</em> is an argument a conversion of <em class="xref py py-obj">orbitals</em> to the equivalent
unique atoms is performed, and subsequently the total number of orbitals on the
atoms is used. This makes it possible to compare the fraction of orbital DOS easier.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'orbital'</span></code></dt><dd><p><span class="math notranslate nohighlight">\(N\)</span> is the sum of selected orbitals, if <em class="xref py py-obj">atoms</em> is specified, this
is equivalent to the ‘atom’ option.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – only return for a given set of atoms (default to all).
<em>NOT</em> allowed with <em class="xref py py-obj">orbitals</em> keyword</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – only return for a given set of orbitals (default to all)
<em>NOT</em> allowed with <em class="xref py py-obj">atoms</em> keyword</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><em>Literal</em></a><em>[</em><em>'none'</em><em>, </em><em>'atom'</em><em>, </em><em>'orbital'</em><em>, </em><em>'all'</em><em>]</em>) – how the normalization of the summed DOS is performed (see <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.norm" title="sisl.io.tbtrans.phtavncSilePHtrans.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a> routine)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.o2p">
<span class="sig-name descname"><span class="pre">o2p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbitals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.o2p" title="Link to this definition"></a></dt>
<dd><p>Return the pivoting indices (0-based) for the orbitals, possibly on an electrode</p>
<p>Will warn if an orbital requested is not in the device list of orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – orbital indices (0-based)</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – electrode to return pivoting indices of (if None it is the
device pivoting indices).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP">
<span class="sig-name descname"><span class="pre">orbital_ACOHP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="Link to this definition"></a></dt>
<dd><p>Orbital resolved COHP analysis of the spectral function</p>
<p>This will return a sparse matrix, see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a> for details.
Each matrix element of the sparse matrix corresponds to the COHP of the
underlying geometry.</p>
<p>The COHP analysis can be written as:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COHP}^{\mathbf A}_{ij} = \frac{1}{2\pi} \Re\big[\mathbf A_{ij}
    \mathbf H_{ij} \big]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the COHP corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of the spectral function</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COHP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COHP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COHP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COHP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP">
<span class="sig-name descname"><span class="pre">orbital_ACOOP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="Link to this definition"></a></dt>
<dd><p>Orbital COOP analysis of the spectral function</p>
<p>This will return a sparse matrix, see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">csr_matrix</span></code></a> for details.
Each matrix element of the sparse matrix corresponds to the COOP of the
underlying geometry.</p>
<p>The COOP analysis can be written as:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COOP}^{\mathbf A}_{ij} = \frac{1}{2\pi} \Re\big[\mathbf A_{ij} \mathbf S_{ji} \big]\]</div>
<p>The sum of the COOP DOS is equal to the DOS:</p>
<div class="math notranslate nohighlight">
\[\mathrm{ADOS}_{i} = \sum_j \mathrm{COOP}^{\mathbf A}_{ij}\]</div>
<p>One can calculate the (diagonal) balanced COOP analysis, see JPCM 15 (2003),
7751-7761 for details. The DBCOOP is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}D &amp;= \sum_i \mathrm{COOP}^{\mathbf A}_{ii}
\\
\mathrm{DBCOOP}^{\mathbf A}_{ij} &amp;= \mathrm{COOP}^{\mathbf A}_{ij} / D\end{split}\]</div>
<p>The BCOOP can be looked up in the reference above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the COOP values corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of the spectral function</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COOP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COOP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COOP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COOP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ACOOP</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_ACOOP</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># COOP @ E = -1 eV from ``0`` spectral function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ACOOP</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="c1"># COOP value between the 11th and 12th orbital</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ACOOP</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="n">tbt</span><span class="o">.</span><span class="n">o_dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ADOS</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">tbt</span><span class="o">.</span><span class="n">Eindex</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">ACOOP</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ADBCOOP</span> <span class="o">=</span> <span class="n">ACOOP</span> <span class="o">/</span> <span class="n">D</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP">
<span class="sig-name descname"><span class="pre">orbital_COHP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="Link to this definition"></a></dt>
<dd><p>Orbital resolved COHP analysis of the Green function</p>
<p>This will return a sparse matrix, see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a> for details.
Each matrix element of the sparse matrix corresponds to the COHP of the
underlying geometry.</p>
<p>The COHP analysis can be written as:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COHP}^{\mathbf G}_{ij} = \frac{-1}{2\pi}
  \Im\big[(\mathbf G - \mathbf G^\dagger)_{ij} \mathbf H_{ji} \big]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the COHP corresponding to the energy.</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COHP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COHP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COHP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COHP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COHP</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_COHP</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># COHP @ E = -1 eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">COHP</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="c1"># COHP value between the 11th and 12th orbital</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP">
<span class="sig-name descname"><span class="pre">orbital_COOP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COOP" title="Link to this definition"></a></dt>
<dd><p>Orbital COOP analysis of the Green function</p>
<p>This will return a sparse matrix, see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a> for details.
Each matrix element of the sparse matrix corresponds to the COOP of the
underlying geometry.</p>
<p>The COOP analysis can be written as:</p>
<div class="math notranslate nohighlight">
\[\mathrm{COOP}^{\mathbf G}_{ij} = \frac{-1}{2\pi}
  \Im\big[(\mathbf G - \mathbf G^\dagger)_{ij} \mathbf S_{ji} \big]\]</div>
<p>The sum of the COOP DOS is equal to the DOS:</p>
<div class="math notranslate nohighlight">
\[\mathrm{DOS}_{i} = \sum_j \mathrm{COOP}^{\mathbf G}_{ij}\]</div>
<p>One can calculate the (diagonal) balanced COOP analysis, see JPCM 15 (2003),
7751-7761 for details. The DBCOOP is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}D &amp;= \sum_i \mathrm{COOP}^{\mathbf G}_{ii}
\\
\mathrm{DBCOOP}^{\mathbf G}_{ij} &amp;= \mathrm{COOP}^{\mathbf G}_{ij} / D\end{split}\]</div>
<p>The BCOOP can be looked up in the reference above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the COOP corresponding to the energy.</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned COOP is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned COOP from unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all COOP for the supercell.
To only get unit cell orbital currents, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain COOP matrix elements for a subset of orbitals, all
other are set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COOP</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_COOP</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># COOP @ E = -1 eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">COOP</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="c1"># COOP value between the 11th and 12th orbital</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">COOP</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="n">tbt</span><span class="o">.</span><span class="n">o_dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DOS</span><span class="p">(</span><span class="nb">sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">tbt</span><span class="o">.</span><span class="n">Eindex</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">COOP</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DBCOOP</span> <span class="o">=</span> <span class="n">COOP</span> <span class="o">/</span> <span class="n">D</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COOP</span></code></a></dt><dd><p>atomic COOP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOOP</span></code></a></dt><dd><p>orbital resolved COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOOP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOOP</span></code></a></dt><dd><p>atomic COOP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_COHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_COHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_COHP</span></code></a></dt><dd><p>atomic COHP analysis of the Green function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_ACOHP</span></code></a></dt><dd><p>orbital resolved COHP analysis of the spectral function</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_ACOHP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_ACOHP</span></code></a></dt><dd><p>atomic COHP analysis of the spectral function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission">
<span class="sig-name descname"><span class="pre">orbital_transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="Link to this definition"></a></dt>
<dd><p>Transmission at energy <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="sisl.io.tbtrans.phtavncSilePHtrans.E"><code class="xref py py-obj docutils literal notranslate"><span class="pre">E</span></code></a> between orbitals originating from <em class="xref py py-obj">elec</em></p>
<p>Each matrix element of the sparse matrix corresponds to the orbital indices of the
underlying geometry (including buffer and electrode atoms).</p>
<p>When requesting orbital-transmissions it is vital to consider how the data needs to be analysed
before extracting the data. For instance, if only local transmission pathways are interesting one should
use <code class="docutils literal notranslate"><span class="pre">what=&quot;+&quot;</span></code> to retain the positive orbital transmissions.
While if one is interested in the transmission between subset of orbitals,
<code class="docutils literal notranslate"><span class="pre">what=&quot;all&quot;</span></code> is the correct method to account for loop transmissions.</p>
<p>The orbital transmissions are calculated as described in the TBtrans manual:</p>
<div class="math notranslate nohighlight">
\[T_{ij}(E) = i [
(\mathbf H_{ji} - E\mathbf S_{ji}) \mathbf A_{ij}(E)
-
(\mathbf H_{ij} - E\mathbf S_{ij}) \mathbf A_{ji}(E)],\]</div>
<p>It is easy to show that the above matrix obeys <span class="math notranslate nohighlight">\(T_{ij}=-T_{ji}\)</span>.</p>
<p>For inexperienced users it is adviced to try out all three values of <code class="docutils literal notranslate"><span class="pre">what</span></code> to ensure
the correct physics is obtained.</p>
<p>This becomes even more important when the orbital transmissions are calculated with magnetic
fields. With <span class="math notranslate nohighlight">\(\mathbf B\)</span> fields local transmission loops may form and the pathways does
not necessarily flow along the transport direction.</p>
<p>For correct interpretation of the orbital transmissions it is vital that one integrates the full
Brillouin zone without any symmetry operations, see Section 5.4 in <span id="id1">[<a class="reference internal" href="../../../references.html#id17" title="Nick Rübner Papior. Computational Tools and Studies of Graphene Nanostructures. PhD thesis, Technical University of Denmark, 2016. URL: http://orbit.dtu.dk/en/publications/computational-tools-and-studies-of-graphene-nanostructures(46f34e1c-5f0c-46cb-be32-fff5f37881aa).html, doi:10.11581/DTU:00000025.">10</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the orbital transmission corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of originating electrons</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned orbital transmission is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned transmissions from the unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all transmissions for the supercell.
To only get unit cell transmissions, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>what</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;all&quot;/&quot;both&quot;/&quot;+-&quot;/&quot;inout&quot;,</span> <span class="pre">&quot;+&quot;/&quot;out&quot;,</span> <span class="pre">&quot;-&quot;/&quot;in&quot;}</span></code>) – which transmissions to return, all, positive (outgoing) or negative (incoming).</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain transmissions for a subset of orbitals (including their supercell equivalents)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">A</span> <span class="pre">`scipy.sparse.csr_matrix</span></code> containing the supercell transmission pathways`, <code class="xref py py-class docutils literal notranslate"><span class="pre">or</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">orbital</span> <span class="pre">transmissions.</span></code></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_transmission</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># orbital current @ E = -1 eV originating from electrode ``0``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> <span class="c1"># orbital transmission from the 11th to the 12th orbital</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_transmission</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">orbitals</span><span class="o">=</span><span class="p">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
<p>only retain transmissions from 1st and 2nd orbitals on first atom type (all atoms of
that type in the entire structure.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_current</span></code></a></dt><dd><p>bias window integrated transmissions</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_transmission</span></code></a></dt><dd><p>energy resolved transmissions between atoms</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_current</span></code></a></dt><dd><p>bias window integrated transmissions (orbital current summed over orbitals)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_transmission</span></code></a></dt><dd><p>an atomic field transmission for each atom (Cartesian representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_current</span></code></a></dt><dd><p>an atomic field current for each atom (Cartesian representation of bond-currents)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_transmission</span></code></a></dt><dd><p>energy resolved atomic transmission for each atom (scalar representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_current" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_current</span></code></a></dt><dd><p>the atomic current for each atom (scalar representation of bond-currents)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.phonon_temperature">
<span class="sig-name descname"><span class="pre">phonon_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/sisl/io/tbtrans/pht.html#phtavncSilePHtrans.phonon_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.phonon_temperature" title="Link to this definition"></a></dt>
<dd><p>Phonon bath temperature [Kelvin]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.pivot">
<span class="sig-name descname"><span class="pre">pivot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot" title="Link to this definition"></a></dt>
<dd><p>Return the pivoting indices for a specific electrode (in the device region) or the device</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – Can be None, to specify the device region pivot indices (default).
Otherwise, it corresponds to the pivoting indicies in the downfolding
region.</p></li>
<li><p><strong>in_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the pivoting table will be translated to the device region orbitals.
If <em class="xref py py-obj">sort</em> is also true, this would correspond to the orbitals directly translated
to the geometry <code class="docutils literal notranslate"><span class="pre">self.geometry.sub(self.a_dev)</span></code>.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether the returned indices are sorted. Mostly useful if you want to handle
the device in a non-pivoted order.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="n">tbtncSileTBtrans</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span><span class="o">.</span><span class="n">pivot</span><span class="p">()</span>
<span class="go">[3, 4, 6, 5, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[2, 3, 4, 5, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">in_device</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[4, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">in_device</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot_down" title="sisl.io.tbtrans.phtavncSilePHtrans.pivot_down"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pivot_down</span></code></a></dt><dd><p>for the pivot table for electrodes down-folding regions</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.pivot_down">
<span class="sig-name descname"><span class="pre">pivot_down</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot_down" title="Link to this definition"></a></dt>
<dd><p>Pivoting orbitals for the downfolding region of a given electrode</p>
<p>This pivoting table includes the electrode + the downfolding region +
the resulting orbitals in the device region.</p>
<p>Essentially this is equivalent to (but not in the same order):
&gt;&gt;&gt; pvt = tbt.geometry.a2o(tbt.a_down(elec), all=True)
&gt;&gt;&gt; pvt_down = np.append(pvt, tbt.pivot(elec))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the corresponding electrode to get the pivoting indices for</p></li>
<li><p><strong>in_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the pivoting table will be translated to the down-folding region
orbitals.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This does <em>not</em> correspond to the atoms of the downfolding region from
the atomic indices:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbt</span><span class="o">.</span><span class="n">pivot_down</span><span class="p">(</span><span class="s2">&quot;Left&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">a2o</span><span class="p">(</span><span class="n">tbt</span><span class="o">.</span><span class="n">a_down</span><span class="p">(</span><span class="s2">&quot;Left&quot;</span><span class="p">),</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The point for this is that <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot_down" title="sisl.io.tbtrans.phtavncSilePHtrans.pivot_down"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pivot_down</span></code></a> is not guaranteed to fully
encapsulate all orbitals of the atoms in the device region.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.plot.geometry">
<span class="sig-prename descclassname"><span class="pre">plot.</span></span><span class="sig-name descname"><span class="pre">geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x',</span> <span class="pre">'y',</span> <span class="pre">'z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_colorscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drawing_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bind_bonds_to_ats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_per_bond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_colorscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'box'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_ndim_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">16,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_ndim_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataaxis_1d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plotly'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.plot.geometry" title="Link to this definition"></a></dt>
<dd><p>Calls <code class="docutils literal notranslate"><span class="pre">read_geometry</span></code> and creates a <code class="docutils literal notranslate"><span class="pre">GeometryPlot</span></code> from its output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>Axes</em>) – The axes to project the geometry to.</p></li>
<li><p><strong>atoms</strong> (<a class="reference internal" href="../../generated/sisl.typing.AtomsIndex.html#sisl.typing.AtomsIndex" title="sisl.typing.AtomsIndex"><em>AtomsIndex</em></a>) – The atoms to plot. If None, all atoms are plotted.</p></li>
<li><p><strong>atoms_style</strong> (<em>Sequence</em><em>[</em><em>AtomsStyleSpec</em><em>]</em>) – List of style specifications for the atoms. See the showcase notebooks for examples.</p></li>
<li><p><strong>atoms_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Scaling factor for the size of all atoms.</p></li>
<li><p><strong>atoms_colorscale</strong> (<em>Optional</em><em>[</em><em>Colorscale</em><em>]</em>) – Colorscale to use for the atoms in case the color attribute is an array of values.
If None, the default colorscale is used for each backend.</p></li>
<li><p><strong>drawing_mode</strong> (<em>Literal</em><em>[</em><em>'scatter'</em><em>, </em><em>'balls'</em><em>, </em><em>None</em><em>]</em>) – The method used to draw the atoms.</p></li>
<li><p><strong>bind_bonds_to_ats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to display only bonds between atoms that are being displayed.</p></li>
<li><p><strong>points_per_bond</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – When the points are drawn using points instead of lines (e.g. in some frameworks
to draw multicolor bonds), the number of points used per bond.</p></li>
<li><p><strong>bonds_style</strong> (<em>StyleSpec</em>) – Style specification for the bonds. See the showcase notebooks for examples.</p></li>
<li><p><strong>bonds_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Scaling factor for the width of all bonds.</p></li>
<li><p><strong>bonds_colorscale</strong> (<em>Optional</em><em>[</em><em>Colorscale</em><em>]</em>) – Colorscale to use for the bonds in case the color attribute is an array of values.
If None, the default colorscale is used for each backend.</p></li>
<li><p><strong>show_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to display the atoms.</p></li>
<li><p><strong>show_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to display the bonds.</p></li>
<li><p><strong>show_cell</strong> (<em>Literal</em><em>[</em><em>'box'</em><em>, </em><em>'axes'</em><em>, </em><em>False</em><em>]</em>) – Mode to display the cell. If False, the cell is not displayed.</p></li>
<li><p><strong>cell_style</strong> (<em>StyleSpec</em>) – Style specification for the cell. See the showcase notebooks for examples.</p></li>
<li><p><strong>nsc</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em>) – Number of unit cells to display in each direction.</p></li>
<li><p><strong>atoms_ndim_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>]</em>) – Scaling factor for the size of the atoms for different dimensionalities (1D, 2D, 3D).</p></li>
<li><p><strong>bonds_ndim_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>]</em>) – Scaling factor for the width of the bonds for different dimensionalities (1D, 2D, 3D).</p></li>
<li><p><strong>dataaxis_1d</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>Callable</em><em>]</em><em>]</em>) – Only meaningful for 1D plots. The data to plot on the Y axis.</p></li>
<li><p><strong>arrows</strong> (<em>Sequence</em><em>[</em><em>AtomArrowSpec</em><em>]</em>) – List of arrow specifications to display. See the showcase notebooks for examples.</p></li>
<li><p><strong>backend</strong> – The backend to use to generate the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../viz/generated/sisl.viz.GeometryPlot.html#sisl.viz.GeometryPlot" title="sisl.viz.plots.geometry.GeometryPlot"><em>GeometryPlot</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeometryPlot</span></code></dt><dd><p>The plot class used to generate the plot.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_geometry</span></code></dt><dd><p>The method called to get the data.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.plot.pdos">
<span class="sig-prename descclassname"><span class="pre">plot.</span></span><span class="sig-name descname"><span class="pre">pdos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[{'name':</span> <span class="pre">'DOS'}]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Erange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'line'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plotly'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.plot.pdos" title="Link to this definition"></a></dt>
<dd><p>Creates a <code class="docutils literal notranslate"><span class="pre">PDOSData</span></code> object and then plots a <code class="docutils literal notranslate"><span class="pre">PdosPlot</span></code> from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><em>Geometry</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – Full geometry of the system (including scattering and electrode regions).
Right now only used to get the basis of each atom, which is not
stored in the TBT.nc file.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><em>None</em></a>) – which electrode to get the PDOS from. Can be None for the Green function,
otherwise the specified. Otherwise it is the index/name of an electrode
so that one gets the ADOS from that electrode.</p></li>
<li><p><strong>groups</strong> (<em>Sequence</em><em>[</em><em>OrbitalStyleQuery</em><em>]</em>) – List of orbital specifications to filter and accumulate the PDOS.
The contribution of each group will be displayed in a different line.
See showcase notebook for examples.</p></li>
<li><p><strong>Erange</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>]</em>) – The energy range to plot.</p></li>
<li><p><strong>E_axis</strong> (<em>Literal</em><em>[</em><em>'x'</em><em>, </em><em>'y'</em><em>]</em>) – Axis to project the energies.</p></li>
<li><p><strong>line_mode</strong> (<em>Literal</em><em>[</em><em>'line'</em><em>, </em><em>'scatter'</em><em>, </em><em>'area_line'</em><em>]</em>) – Mode used to draw the PDOS lines.</p></li>
<li><p><strong>line_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Scaling factor for the width of all lines.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The backend to generate the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../../viz/generated/sisl.viz.PdosPlot.html#sisl.viz.PdosPlot" title="sisl.viz.plots.pdos.PdosPlot"><em>PdosPlot</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PdosPlot</span></code></dt><dd><p>The plot class used to generate the plot.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PDOSData</span></code></dt><dd><p>The class to which data is converted.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.read" title="Link to this definition"></a></dt>
<dd><p>Generic read method which should be overloaded in child-classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – keyword arguments will try and search for the attribute <code class="docutils literal notranslate"><span class="pre">read_&lt;&gt;</span></code>
and call it with the remaining <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> as arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.read_brillouinzone">
<span class="sig-name descname"><span class="pre">read_brillouinzone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_brillouinzone" title="Link to this definition"></a></dt>
<dd><p>Returns a <em class="xref py py-obj">BrillouinZone</em> object with the k-points associated</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../generated/sisl.physics.BrillouinZone.html#sisl.physics.BrillouinZone" title="sisl.physics.BrillouinZone"><em>BrillouinZone</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.read_data">
<span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_data" title="Link to this definition"></a></dt>
<dd><p>Read specific type of data.</p>
<p>This is a generic routine for reading different parts of the data-file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – return the geometry</p></li>
<li><p><strong>vector_transmission</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – return the bond transmissions as vectors</p></li>
<li><p><strong>vector_current</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – return the bond currents as vectors</p></li>
<li><p><strong>atom_transmission</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – return the atomic transmission flowing through an atom (the <em>activity</em> current)</p></li>
<li><p><strong>atom_current</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – return the atomic current flowing through an atom (the <em>activity</em> current)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.read_geometry">
<span class="sig-name descname"><span class="pre">read_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_geometry" title="Link to this definition"></a></dt>
<dd><p>Returns <em class="xref py py-obj">Geometry</em> object from this file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.read_lattice">
<span class="sig-name descname"><span class="pre">read_lattice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.read_lattice" title="Link to this definition"></a></dt>
<dd><p>Returns <em class="xref py py-obj">Lattice</em> object from this file</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../generated/sisl.Lattice.html#sisl.Lattice" title="sisl.Lattice"><em>Lattice</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.reflection">
<span class="sig-name descname"><span class="pre">reflection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_single</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.reflection" title="Link to this definition"></a></dt>
<dd><p>Reflection into electrode <em class="xref py py-obj">elec</em></p>
<p>The reflection into electrode <em class="xref py py-obj">elec</em> is calculated as:</p>
<div class="math notranslate nohighlight">
\[R(E) = T_{\mathrm{bulk}}(E) - \sum_{\mathrm{to}} T_{\mathrm{elec}\to\mathrm{to}}(E)\]</div>
<p>Another way of calculating the reflection is via:</p>
<div class="math notranslate nohighlight">
\[R(E) = T_{\mathrm{bulk}}(E) - \big\{i \mathrm{Tr}[(\mathbf G-\mathbf G^\dagger)\boldsymbol\Gamma_{\mathrm{elec}}]
      - \mathrm{Tr}[\mathbf G\boldsymbol\Gamma_{\mathrm{elec}}\mathbf G^\dagger\boldsymbol\Gamma_{\mathrm{elec}}]\big\}\]</div>
<p>Both are identical, however, numerically they may be different. Particularly when the bulk transmission
is very large compared to the transmission to the other electrodes one should prefer the first equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the backscattered electrode</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned reflection is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>from_single</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the reflection is calculated using the Green function and a
single scattering matrix Eq. (2) above (true), otherwise Eq. (1) will be used (false).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission</span></code></a></dt><dd><p>the total transmission</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_eig</span></code></a></dt><dd><p>the transmission decomposed in eigenchannels</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_bulk</span></code></a></dt><dd><p>the total transmission in a periodic lead</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.sparse_atom_to_vector">
<span class="sig-name descname"><span class="pre">sparse_atom_to_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dab</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_atom_to_vector" title="Link to this definition"></a></dt>
<dd><p>Reduce an atomic sparse matrix to a vector contribution of each atom</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This routine may be moved to a <code class="docutils literal notranslate"><span class="pre">sisl.utility</span></code> at some point since it would
be a generic routine usable for other parts of <a class="reference internal" href="../../../index.html#module-sisl" title="sisl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Dab</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>) – the input sparse matrix in atomic indices</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom">
<span class="sig-name descname"><span class="pre">sparse_orbital_to_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_dup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom" title="Link to this definition"></a></dt>
<dd><p>Reduce a sparse matrix in orbital sparse to a sparse matrix in atomic indices</p>
<p>This algorithm <em>may</em> keep the same non-zero entries, but will return
a new csr_matrix with duplicate indices.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This routine may be moved to a <code class="docutils literal notranslate"><span class="pre">sisl.utility</span></code> at some point since it would
be a generic routine usable for other parts of <a class="reference internal" href="../../../index.html#module-sisl" title="sisl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dij</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>) – the input sparse matrix in orbital format</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned data are only in the unit-cell.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
<li><p><strong>sum_dup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – duplicates will be summed if this is true, in this case, no duplicates are
present in the returned sparse matrix. If false, duplicates may exist for
multi-orbital systems.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><em>csr_matrix</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_scalar">
<span class="sig-name descname"><span class="pre">sparse_orbital_to_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_scalar" title="Link to this definition"></a></dt>
<dd><p>Atomic scalar contribution of atoms for a sparse orbital matrix</p>
<p>The atomic contribution is a single number specifying a figure of the <em>magnitude</em>
of sparse matrix elements for each atom. It is thus <em>not</em> a quantity that can be related to
any physical quantity that the sparse matrix may represent but is merely a number that provides an
idea of <em>how much</em> this atom is governing the data in the matrix.</p>
<p>The atomic contribution may have two meanings based on these two equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf a_I^{|a|} &amp;=\frac 12 \sum_{\{J\}} \Big| \sum_{i\in I}\sum_{j\in J} \mathbf A_{ij} \Big|
\\
\mathbf a_I^{|o|} &amp;=\frac 12 \sum_{i\in I}\sum_{j\in\{J\}} \big| A_{ij} \big|\end{split}\]</div>
<p>If the <em>activity</em> is requested (<code class="docutils literal notranslate"><span class="pre">activity=True</span></code>)
<span class="math notranslate nohighlight">\(\mathbf a_I^{\mathcal A} = \sqrt{\mathbf a_I^{|a|} \mathbf a_I^{|o|} }\)</span> is returned.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">activity=False</span></code> <span class="math notranslate nohighlight">\(\mathbf a_I^{|a|}\)</span> is returned.</p>
<p>For geometries with all atoms only having 1-orbital, they are equivalent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dij</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>) – the orbital sparse matrix.</p></li>
<li><p><strong>activity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> to return the atomic activity, see explanation above</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This routine may be moved to a <code class="docutils literal notranslate"><span class="pre">sisl.utility</span></code> at some point since it would
be a generic routine usable for other parts of <a class="reference internal" href="../../../index.html#module-sisl" title="sisl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl</span></code></a>.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Jij</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">orbital_current</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.03</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span> <span class="c1"># orbital current @ E = -1 eV originating from electrode ``0``</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ja</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">sparse_orbital_to_scalar</span><span class="p">(</span><span class="n">Jij</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_vector">
<span class="sig-name descname"><span class="pre">sparse_orbital_to_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_dup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_vector" title="Link to this definition"></a></dt>
<dd><p>Reduce an orbital sparse matrix to a vector contribution of each atom</p>
<p>Equivalent to calling <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_orbital_to_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_orbital_to_atom</span></code></a> and <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.sparse_atom_to_vector" title="sisl.io.tbtrans.phtavncSilePHtrans.sparse_atom_to_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse_atom_to_vector</span></code></a>.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This routine may be moved to a <code class="docutils literal notranslate"><span class="pre">sisl.utility</span></code> at some point since it would
be a generic routine usable for other parts of <a class="reference internal" href="../../../index.html#module-sisl" title="sisl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dij</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.16.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>) – the input sparse matrix</p></li>
<li><p><strong>uc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned data are only in the unit-cell.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> this will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na)</span></code>,
else, it will return a sparse matrix of <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">(self.na,</span> <span class="pre">self.na</span> <span class="pre">*</span> <span class="pre">self.n_s)</span></code>.
One may figure out the connections via <code class="xref py py-obj docutils literal notranslate"><span class="pre">sc_index</span></code>.</p></li>
<li><p><strong>sum_dup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – duplicates will be summed if this is true, in this case, no duplicates are
present in the returned sparse matrix. If false, duplicates may exist for
multi-orbital systems.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.transmission">
<span class="sig-name descname"><span class="pre">transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec_from</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission" title="Link to this definition"></a></dt>
<dd><p>Transmission from <em class="xref py py-obj">elec_from</em> to <em class="xref py py-obj">elec_to</em>.</p>
<p>The transmission between two electrodes may be retrieved
from the <em class="xref py py-obj">Sile</em>.</p>
<p>The transmission is calculated as:</p>
<div class="math notranslate nohighlight">
\[T(E) = \mathrm{Tr}[\mathbf{G}\boldsymbol\Gamma_{\mathrm{from}}\mathbf{G}^\dagger\boldsymbol\Gamma_{\mathrm{to}}]\]</div>
<p>where all quantities are energy dependent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec_from</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the originating electrode</p></li>
<li><p><strong>elec_to</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the absorbing electrode (different from <em class="xref py py-obj">elec_from</em>)</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned transmission is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_eig</span></code></a></dt><dd><p>the transmission decomposed in eigenchannels</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_bulk</span></code></a></dt><dd><p>the total transmission in a periodic lead</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.reflection" title="sisl.io.tbtrans.phtavncSilePHtrans.reflection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reflection</span></code></a></dt><dd><p>total reflection back into the electrode</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk">
<span class="sig-name descname"><span class="pre">transmission_bulk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk" title="Link to this definition"></a></dt>
<dd><p>Bulk transmission for the <em class="xref py py-obj">elec</em> electrode</p>
<p>The bulk transmission is equivalent to creating a 2 terminal device with
electrode <em class="xref py py-obj">elec</em> tiled 3 times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the bulk electrode</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned transmission are k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission</span></code></a></dt><dd><p>the total transmission</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_eig</span></code></a></dt><dd><p>the transmission decomposed in eigenchannels</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.reflection" title="sisl.io.tbtrans.phtavncSilePHtrans.reflection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reflection</span></code></a></dt><dd><p>total reflection back into the electrode</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig">
<span class="sig-name descname"><span class="pre">transmission_eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec_from</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_eig" title="Link to this definition"></a></dt>
<dd><p>Transmission eigenvalues from <em class="xref py py-obj">elec_from</em> to <em class="xref py py-obj">elec_to</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec_from</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the originating electrode</p></li>
<li><p><strong>elec_to</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the absorbing electrode (different from <em class="xref py py-obj">elec_from</em>)</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned transmission eigenvalues are k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>ndarray</em></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission</span></code></a></dt><dd><p>the total transmission</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk" title="sisl.io.tbtrans.phtavncSilePHtrans.transmission_bulk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transmission_bulk</span></code></a></dt><dd><p>the total transmission in a periodic lead</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission">
<span class="sig-name descname"><span class="pre">vector_transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_transmission" title="Link to this definition"></a></dt>
<dd><p>Vector for each atom being the sum of bond transmissions times the normalized bond vector between the atoms</p>
<p>The vector transmission is defined as:</p>
<div class="math notranslate nohighlight">
\[\mathbf T_I = \sum_J \frac{\mathbf r^{(J)} - \mathbf r^{(I)}}{|\mathbf r^{(J)} - \mathbf r^{(I)}|} \cdot T_{IJ}\]</div>
<p>Where <span class="math notranslate nohighlight">\(T_{IJ}\)</span> is the bond transmission between atom <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\(J\)</span> and
<span class="math notranslate nohighlight">\(\mathbf r^{(\langle\rangle)}\)</span> are the atomic coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – the vector transmission corresponding to the energy.</p></li>
<li><p><strong>elec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – the electrode of originating electrons</p></li>
<li><p><strong>kavg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – whether the returned vector transmission is k-averaged, or an explicit (unweighed) k-point
is returned</p></li>
<li><p><strong>isc</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <em>optional</em>) – the returned vectors from the unit-cell (<code class="docutils literal notranslate"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>) to
the given supercell, the default is all vectors for the supercell.
To only get unit cell vectors, pass <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p></li>
<li><p><strong>what</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;all&quot;/&quot;both&quot;/&quot;+-&quot;/&quot;inout&quot;,</span> <span class="pre">&quot;+&quot;/&quot;out&quot;,</span> <span class="pre">&quot;-&quot;/&quot;in&quot;}</span></code>) – The <em>outgoing</em> vectors may be retrieved by <code class="docutils literal notranslate"><span class="pre">&quot;out&quot;</span></code>.
The <em>incoming</em> vectors may be retrieved by <code class="docutils literal notranslate"><span class="pre">&quot;in&quot;</span></code>, while the
average incoming and outgoing direction can be obtained with <code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code>.
In the last case the vector transmissions are divided by 2 to ensure the length
of the vector is compatible with the other options; given a pristine system.</p></li>
<li><p><strong>orbitals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – only retain transmissions for a subset of orbitals before calculating bond transmissions
Passed directly to <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of vectors per atom in the Geometry (only non-zero for device atoms)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_transmission</span></code></a></dt><dd><p>energy resolved transmission between orbitals</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_current</span></code></a></dt><dd><p>bias window integrated transmissions</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_transmission</span></code></a></dt><dd><p>energy resolved transmissions between atoms</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="sisl.io.tbtrans.phtavncSilePHtrans.bond_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_current</span></code></a></dt><dd><p>bias window integrated transmissions (orbital current summed over orbitals)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="sisl.io.tbtrans.phtavncSilePHtrans.vector_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_current</span></code></a></dt><dd><p>an atomic field current for each atom (Cartesian representation of bond-currents)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_transmission"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_transmission</span></code></a></dt><dd><p>energy resolved atomic transmission for each atom (scalar representation of bond-transmissions)</p>
</dd>
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.atom_current" title="sisl.io.tbtrans.phtavncSilePHtrans.atom_current"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atom_current</span></code></a></dt><dd><p>the atomic current for each atom (scalar representation of bond-currents)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.write" title="Link to this definition"></a></dt>
<dd><p>Generic write method which should be overloaded in child-classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – keyword arguments will try and search for the attribute <em class="xref py py-obj">write_</em>
and call it with the remaining <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> as arguments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.write_tbtav">
<span class="sig-name descname"><span class="pre">write_tbtav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.write_tbtav" title="Link to this definition"></a></dt>
<dd><p>Wrapper for writing the k-averaged TBT.AV.nc file.</p>
<p>This write <em>requires</em> the TBT.nc <em class="xref py py-obj">Sile</em> object passed as the first argument,
or as the keyword <code class="docutils literal notranslate"><span class="pre">from=tbt</span></code> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>from</strong> (<a class="reference internal" href="sisl.io.tbtrans.tbtncSileTBtrans.html#sisl.io.tbtrans.tbtncSileTBtrans" title="sisl.io.tbtrans.tbtncSileTBtrans"><code class="xref py py-class docutils literal notranslate"><span class="pre">tbtncSileTBtrans</span></code></a>) – the TBT.nc file object that has the k-sampled quantities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">E</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.E" title="Link to this definition"></a></dt>
<dd><p>Sampled energy-points in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.a_buf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a_buf</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_buf" title="Link to this definition"></a></dt>
<dd><p>Atomic indices (0-based) of device atoms</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.a_dev">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a_dev</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.a_dev" title="Link to this definition"></a></dt>
<dd><p>Atomic indices (0-based) of device atoms (sorted)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.base_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_file</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.base_file" title="Link to this definition"></a></dt>
<dd><p>File of the current <em class="xref py py-obj">Sile</em></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.bond_current">
<span class="sig-name descname"><span class="pre">bond_current</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.bond_current" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.cell" title="Link to this definition"></a></dt>
<dd><p>Unit cell in file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.chemical_potential">
<span class="sig-name descname"><span class="pre">chemical_potential</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.chemical_potential" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.current">
<span class="sig-name descname"><span class="pre">current</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.current" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.current_parameter">
<span class="sig-name descname"><span class="pre">current_parameter</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.current_parameter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.elecs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">elecs</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.elecs" title="Link to this definition"></a></dt>
<dd><p>List of electrodes</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.electron_temperature">
<span class="sig-name descname"><span class="pre">electron_temperature</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.electron_temperature" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.fano">
<span class="sig-name descname"><span class="pre">fano</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.fano" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">file</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.file" title="Link to this definition"></a></dt>
<dd><p>File of the current <em class="xref py py-obj">Sile</em></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><span class="pre">Geometry</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.geometry" title="Link to this definition"></a></dt>
<dd><p>The associated geometry from this file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.k">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.k" title="Link to this definition"></a></dt>
<dd><p>Sampled k-points in file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.kT">
<span class="sig-name descname"><span class="pre">kT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.kT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.kpt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kpt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.kpt" title="Link to this definition"></a></dt>
<dd><p>Sampled k-points in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.lasto">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lasto</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.lasto" title="Link to this definition"></a></dt>
<dd><p>Last orbital of corresponding atom</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.nE">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nE</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.nE" title="Link to this definition"></a></dt>
<dd><p>Number of energy-points in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">na</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na" title="Link to this definition"></a></dt>
<dd><p>Returns number of atoms in the cell</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na_b">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">na_b</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_b" title="Link to this definition"></a></dt>
<dd><p>Number of atoms in the buffer region</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na_buffer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">na_buffer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_buffer" title="Link to this definition"></a></dt>
<dd><p>Number of atoms in the buffer region</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na_d">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">na_d</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_d" title="Link to this definition"></a></dt>
<dd><p>Number of atoms in the device region</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na_dev">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">na_dev</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_dev" title="Link to this definition"></a></dt>
<dd><p>Number of atoms in the device region</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.na_u">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">na_u</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.na_u" title="Link to this definition"></a></dt>
<dd><p>Returns number of atoms in the cell</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.ne">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ne</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.ne" title="Link to this definition"></a></dt>
<dd><p>Number of energy-points in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.nk">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nk</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.nk" title="Link to this definition"></a></dt>
<dd><p>Number of k-points in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.nkpt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nkpt</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.nkpt" title="Link to this definition"></a></dt>
<dd><p>Always return 1, this is to signal other routines</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.no">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">no</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.no" title="Link to this definition"></a></dt>
<dd><p>Returns number of orbitals in the cell</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.no_d">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">no_d</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_d" title="Link to this definition"></a></dt>
<dd><p>Number of orbitals in the device region</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.no_u">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">no_u</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.no_u" title="Link to this definition"></a></dt>
<dd><p>Returns number of orbitals in the cell</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.noise_power">
<span class="sig-name descname"><span class="pre">noise_power</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.noise_power" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.o_dev">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">o_dev</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.o_dev" title="Link to this definition"></a></dt>
<dd><p>Orbital indices (0-based) of device orbitals (sorted)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans.pivot" title="sisl.io.tbtrans.phtavncSilePHtrans.pivot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pivot</span></code></a></dt><dd><p>retrieve the device orbitals, non-sorted</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.orbital_current">
<span class="sig-name descname"><span class="pre">orbital_current</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.orbital_current" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.plot" title="Link to this definition"></a></dt>
<dd><p>Plotting functions for the <a class="reference internal" href="#sisl.io.tbtrans.phtavncSilePHtrans" title="sisl.io.tbtrans.phtavncSilePHtrans"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phtavncSilePHtrans</span></code></a> class.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.shot_noise">
<span class="sig-name descname"><span class="pre">shot_noise</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.shot_noise" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.vector_current">
<span class="sig-name descname"><span class="pre">vector_current</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.vector_current" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.wk">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wk</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.wk" title="Link to this definition"></a></dt>
<dd><p>Weights of k-points in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.wkpt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wkpt</span></span><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.wkpt" title="Link to this definition"></a></dt>
<dd><p>Always return [1.], this is to signal other routines</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.xa">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.xa" title="Link to this definition"></a></dt>
<dd><p>Atomic coordinates in file</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sisl.io.tbtrans.phtavncSilePHtrans.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#sisl.io.tbtrans.phtavncSilePHtrans.xyz" title="Link to this definition"></a></dt>
<dd><p>Atomic coordinates in file</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sisl.io.tbtrans.phtsencSilePHtrans.html" class="btn btn-neutral float-left" title="sisl.io.tbtrans.phtsencSilePHtrans" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sisl.io.tbtrans.phtprojncSilePHtrans.html" class="btn btn-neutral float-right" title="sisl.io.tbtrans.phtprojncSilePHtrans" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2025, sisl developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>