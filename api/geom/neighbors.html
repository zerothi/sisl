

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Finding neighbors &mdash; sisl</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom_styles.css?v=cafe85c1" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=e6894c64"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=7800a641"></script>
      <script src="../../_static/tabs.js?v=3ee01567"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="sisl.geom.NeighborFinder" href="generated/sisl.geom.NeighborFinder.html" />
    <link rel="prev" title="sisl.geom.CompositeGeometrySection" href="generated/sisl.geom.CompositeGeometrySection.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            sisl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Citing sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization/index.html">Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.viz</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts/index.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basic.html">Basic classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Geometry handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.geom</span></code>)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="building.html">Creating geometries</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Finding neighbors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.NeighborFinder.html">sisl.geom.NeighborFinder</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.FullNeighborList.html">sisl.geom.FullNeighborList</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.UniqueNeighborList.html">sisl.geom.UniqueNeighborList</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.PartialNeighborList.html">sisl.geom.PartialNeighborList</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.AtomNeighborList.html">sisl.geom.AtomNeighborList</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.CoordsNeighborList.html">sisl.geom.CoordsNeighborList</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/sisl.geom.CoordNeighborList.html">sisl.geom.CoordNeighborList</a></li>
<li class="toctree-l4"><a class="reference internal" href="#neighbor-lists">Neighbor lists</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="indexing.html">Indexing atoms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../physics.html">Physical objects (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.physics</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mixing.html">Mixing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.mixing</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../viz/index.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit_constant.html">Units and constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utilities.html">Utilities (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.utils</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core.html">Functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/index.html">Input/Output (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.io</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../typing.html">Typing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.typing</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../environment.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../toolbox/index.html">Toolboxes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev/index.html">Contributing to sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../math.html">Mathematical notation convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other.html">Related software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API reference</a></li>
          <li class="breadcrumb-item"><a href="index.html">Geometry handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.geom</span></code>)</a></li>
      <li class="breadcrumb-item active">Finding neighbors</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/geom/neighbors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="finding-neighbors">
<span id="geom-neighbors"></span><h1>Finding neighbors<a class="headerlink" href="#finding-neighbors" title="Link to this heading"></a></h1>
<p><a class="reference internal" href="../../index.html#module-sisl" title="sisl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl</span></code></a> implements an <strong>algorithm to find neighbors in a geometry</strong>. It has two main properties:</p>
<p><span class="fas fa-truck-fast"></span> <strong>It is very fast</strong>. It can compute all the neighbors for a system of 3 million atoms in around 6 seconds.</p>
<p><span class="fas fa-maximize"></span> <strong>It scales linearly</strong> with the number of atoms in the system.</p>
<p>The algorithm is based on the <strong>partition of space into bins</strong>. This partition limits the search for
neighbors of a certain atom only within the bins adjacent to the bin the atom is in.</p>
<p>Since the bins must be created only once, there is a <a class="reference internal" href="generated/sisl.geom.NeighborFinder.html#sisl.geom.NeighborFinder" title="sisl.geom.NeighborFinder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NeighborFinder</span></code></a> class which <strong>on initialization
creates the bin grid</strong>. Once the finder is created, you can query it for neighbors as many times
as you want. You can ask for all neighbors or only the neighbors of atoms that you are interested in.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.NeighborFinder.html#sisl.geom.NeighborFinder" title="sisl.geom.NeighborFinder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NeighborFinder</span></code></a></p></td>
<td><p>Fast and linear scaling finding of neighbors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/sisl.geom.FullNeighborList.html#sisl.geom.FullNeighborList" title="sisl.geom.FullNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FullNeighborList</span></code></a></p></td>
<td><p>Full neighbors list of a system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.UniqueNeighborList.html#sisl.geom.UniqueNeighborList" title="sisl.geom.UniqueNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UniqueNeighborList</span></code></a></p></td>
<td><p>Full neighbors list of a system, but <strong>containing only the upper triangle of the adjacency matrix</strong>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/sisl.geom.PartialNeighborList.html#sisl.geom.PartialNeighborList" title="sisl.geom.PartialNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PartialNeighborList</span></code></a></p></td>
<td><p>Neighbors list containing only the neighbors of some atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.AtomNeighborList.html#sisl.geom.AtomNeighborList" title="sisl.geom.AtomNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtomNeighborList</span></code></a></p></td>
<td><p>List of atoms that are close to a given atom.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/sisl.geom.CoordsNeighborList.html#sisl.geom.CoordsNeighborList" title="sisl.geom.CoordsNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordsNeighborList</span></code></a></p></td>
<td><p>List of atoms that are close to a set of coordinates in space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.CoordNeighborList.html#sisl.geom.CoordNeighborList" title="sisl.geom.CoordNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordNeighborList</span></code></a></p></td>
<td><p>List of atoms that are close to a coordinate in space.</p></td>
</tr>
</tbody>
</table>
<section id="neighbor-lists">
<h2>Neighbor lists<a class="headerlink" href="#neighbor-lists" title="Link to this heading"></a></h2>
<p>Once created, a neighbor finder can be queried to get the neighbors. It will return a neighbor list.
Depending on which type of query you make to the neighbor finder, it will return a different type of
neighbor list.</p>
<p>The following table summarizes the properties of each type of neighbor list:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Neighbors for</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(I &lt; J\)</span></p></th>
<th class="head"><p>Items</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="generated/sisl.geom.FullNeighborList.html#sisl.geom.FullNeighborList" title="sisl.geom.FullNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FullNeighborList</span></code></a></p></td>
<td><p>All atoms</p></td>
<td><p><span class="fas fa-circle-xmark"></span></p></td>
<td><p><a class="reference internal" href="generated/sisl.geom.AtomNeighborList.html#sisl.geom.AtomNeighborList" title="sisl.geom.AtomNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtomNeighborList</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.UniqueNeighborList.html#sisl.geom.UniqueNeighborList" title="sisl.geom.UniqueNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UniqueNeighborList</span></code></a></p></td>
<td><p>All atoms</p></td>
<td><p><span class="fas fa-circle-check"></span></p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/sisl.geom.PartialNeighborList.html#sisl.geom.PartialNeighborList" title="sisl.geom.PartialNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PartialNeighborList</span></code></a></p></td>
<td><p>Selected atoms</p></td>
<td><p><span class="fas fa-circle-xmark"></span></p></td>
<td><p><a class="reference internal" href="generated/sisl.geom.AtomNeighborList.html#sisl.geom.AtomNeighborList" title="sisl.geom.AtomNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtomNeighborList</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.AtomNeighborList.html#sisl.geom.AtomNeighborList" title="sisl.geom.AtomNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AtomNeighborList</span></code></a></p></td>
<td><p>One atom</p></td>
<td><p><span class="fas fa-circle-xmark"></span></p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="generated/sisl.geom.CoordsNeighborList.html#sisl.geom.CoordsNeighborList" title="sisl.geom.CoordsNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordsNeighborList</span></code></a></p></td>
<td><p>Coordinates in space</p></td>
<td><p><span class="fas fa-circle-xmark"></span></p></td>
<td><p><a class="reference internal" href="generated/sisl.geom.CoordNeighborList.html#sisl.geom.CoordNeighborList" title="sisl.geom.CoordNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordNeighborList</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/sisl.geom.CoordNeighborList.html#sisl.geom.CoordNeighborList" title="sisl.geom.CoordNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoordNeighborList</span></code></a></p></td>
<td><p>Coordinate in space</p></td>
<td><p><span class="fas fa-circle-xmark"></span></p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I &lt; J\)</span> indicates whether the list only contains one direction of the interaction, i.e. by omitting
the transposed interaction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Items</span></code> indicates the type that you get when you iterate over indices (e.g. <code class="docutils literal notranslate"><span class="pre">neighbors[0]</span></code>) the list.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="generated/sisl.geom.CompositeGeometrySection.html" class="btn btn-neutral float-left" title="sisl.geom.CompositeGeometrySection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="generated/sisl.geom.NeighborFinder.html" class="btn btn-neutral float-right" title="sisl.geom.NeighborFinder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2025, sisl developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>