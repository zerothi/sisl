

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sisl.geom.NeighborFinder &mdash; sisl</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom_styles.css?v=cafe85c1" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=f8dfdfa1"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=7800a641"></script>
      <script src="../../../_static/tabs.js?v=3ee01567"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="sisl.geom.FullNeighborList" href="sisl.geom.FullNeighborList.html" />
    <link rel="prev" title="Finding neighbors" href="../neighbors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            sisl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cite.html">Citing sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualization/index.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/index.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../basic.html">Basic classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building.html">Common geometries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../neighbors.html">Finding neighbors</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">sisl.geom.NeighborFinder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sisl.geom.NeighborFinder"><code class="docutils literal notranslate"><span class="pre">NeighborFinder</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sisl.geom.FullNeighborList.html">sisl.geom.FullNeighborList</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.geom.UniqueNeighborList.html">sisl.geom.UniqueNeighborList</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.geom.PartialNeighborList.html">sisl.geom.PartialNeighborList</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.geom.AtomNeighborList.html">sisl.geom.AtomNeighborList</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.geom.PointsNeighborList.html">sisl.geom.PointsNeighborList</a></li>
<li class="toctree-l3"><a class="reference internal" href="sisl.geom.PointNeighborList.html">sisl.geom.PointNeighborList</a></li>
<li class="toctree-l3"><a class="reference internal" href="../neighbors.html#neighbor-lists">Neighbor lists</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../physics.html">Physical objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mixing.html">Mixing self-consistent quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../viz/index.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../unit_constant.html">Units and constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core.html">Functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/index.html">Input/Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../typing.html">Typing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../environment.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../toolbox/index.html">Toolboxes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/index.html">Contributing to sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../math.html">Mathematical notation convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other.html">Related software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">API reference</a></li>
          <li class="breadcrumb-item"><a href="../neighbors.html">Finding neighbors</a></li>
      <li class="breadcrumb-item active">sisl.geom.NeighborFinder</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/api/geom/generated/sisl.geom.NeighborFinder.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sisl-geom-neighborfinder">
<h1>sisl.geom.NeighborFinder<a class="headerlink" href="#sisl-geom-neighborfinder" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sisl.geom.</span></span><span class="sig-name descname"><span class="pre">NeighborFinder</span></span><a class="headerlink" href="#sisl.geom.NeighborFinder" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Fast and linear scaling finding of neighbors.</p>
<p>Once this class is instantiated, a table is built. Then,
the neighbor finder can be queried as many times as wished
as long as the geometry doesn’t change.</p>
<p>Note that the radius (<em class="xref py py-obj">R</em>) is used to build the table.
Therefore, if one wants to look for neighbors using a different
R, one needs to create another finder or call <a class="reference internal" href="#sisl.geom.NeighborFinder.setup" title="sisl.geom.NeighborFinder.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">sisl.Geometry</span></code></a>) – the geometry to find neighbors in</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array-like</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(geometry.na)</span></code>, <em>optional</em>) – <p>The radius to consider two atoms neighbors.
If it is a single float, the same radius is used for all atoms.
If it is an array, it should contain the radius for each atom.</p>
<p>If not provided, an array is constructed, where the radius for
each atom is its maxR.</p>
</p></li>
<li><p><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – <p>If <em class="xref py py-obj">True</em>, two atoms are considered neighbors if their spheres
overlap.
If <em class="xref py py-obj">False</em>, two atoms are considered neighbors if the second atom
is within the sphere of the first atom. Note that this implies that
atom <code class="docutils literal notranslate"><span class="pre">i</span></code> might be atom <code class="docutils literal notranslate"><span class="pre">j</span></code>’s neighbor while the opposite is not true.</p>
<p>If not provided, it will be <em class="xref py py-obj">True</em> if <em class="xref py py-obj">R</em> is an array and <em class="xref py py-obj">False</em> if
it is a single float.</p>
</p></li>
<li><p><strong>bin_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – the factor for the radius to determine how large the bins are,
optionally along each lattice vector.
It can minimally be 2, meaning that the maximum radius to consider
is twice the radius considered. For larger values, more atoms will be in
each bin (and thus fewer bins).
Hence, this value can be used to fine-tune the memory requirement by
decreasing number of bins, at the cost of a bit more run-time searching
bins.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>You need to initialize it with a geometry and the cutoff radius. Then,
you can call the <code class="docutils literal notranslate"><span class="pre">find_neighbors</span></code>, <code class="docutils literal notranslate"><span class="pre">find_unique_pairs</span></code> or <code class="docutils literal notranslate"><span class="pre">find_close</span></code>
methods to query the finder for neighbors. These methods will return a neighbors
list (e.g <code class="docutils literal notranslate"><span class="pre">find_neighbors</span></code> returns a <code class="docutils literal notranslate"><span class="pre">FullNeighborList</span></code>).</p>
<p>Here is an example of how to find all neighbors on a graphene structure with
a vacancy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sisl</span>

<span class="c1"># Build a graphene supercell with a vacancy</span>
<span class="n">graphene</span> <span class="o">=</span> <span class="n">sisl</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">graphene</span><span class="p">()</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">graphene</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">translate2uc</span><span class="p">()</span>

<span class="c1"># Initialize a finder for neighbors that are within 1.5 Angstrom</span>
<span class="n">finder</span> <span class="o">=</span> <span class="n">sisl</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">NeighborFinder</span><span class="p">(</span><span class="n">graphene</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Find all neighbors</span>
<span class="n">neighbors</span> <span class="o">=</span> <span class="n">finder</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">()</span>

<span class="c1"># You can get the neighbor pairs (i,j) from the i and j attributes</span>
<span class="c1"># The supercell index of atom J is in the isc attribute.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ATOM I SHAPE:&quot;</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ATOM J (NEIGHBOR) SHAPE:&quot;</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">j</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NEIGHBORS ISC:&quot;</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">isc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># You can also loop through atoms to get their neighbors</span>
<span class="k">for</span> <span class="n">at_neighs</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NEIGHBORS OF ATOM </span><span class="si">{</span><span class="n">at_neighs</span><span class="o">.</span><span class="n">atom</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">at_neighs</span><span class="o">.</span><span class="n">n_neighbors</span><span class="si">}</span><span class="s2"> neighbors): &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="n">at_neighs</span><span class="o">.</span><span class="n">j</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ISC&quot;</span><span class="p">,</span> <span class="n">at_neighs</span><span class="o">.</span><span class="n">isc</span><span class="p">)</span>

<span class="c1"># Or get the neighbors of a particular atom:</span>
<span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">j</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="sisl.geom.FullNeighborList.html#sisl.geom.FullNeighborList" title="sisl.geom.FullNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FullNeighborList</span></code></a>, <a class="reference internal" href="sisl.geom.UniqueNeighborList.html#sisl.geom.UniqueNeighborList" title="sisl.geom.UniqueNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UniqueNeighborList</span></code></a>, <a class="reference internal" href="sisl.geom.PartialNeighborList.html#sisl.geom.PartialNeighborList" title="sisl.geom.PartialNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PartialNeighborList</span></code></a>, <a class="reference internal" href="sisl.geom.PointsNeighborList.html#sisl.geom.PointsNeighborList" title="sisl.geom.PointsNeighborList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PointsNeighborList</span></code></a></p>
</div>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.geom.NeighborFinder.assert_consistency" title="sisl.geom.NeighborFinder.assert_consistency"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assert_consistency</span></code></a>()</p></td>
<td><p>Asserts that the data structure (self._list, self._heads, self._counts) is consistent.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.geom.NeighborFinder.find_close" title="sisl.geom.NeighborFinder.find_close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_close</span></code></a>(xyz)</p></td>
<td><p>Find all atoms that are close to some coordinates in space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.geom.NeighborFinder.find_neighbors" title="sisl.geom.NeighborFinder.find_neighbors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_neighbors</span></code></a>([atoms, self_interaction])</p></td>
<td><p>Find neighbors as specified in the finder.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sisl.geom.NeighborFinder.find_unique_pairs" title="sisl.geom.NeighborFinder.find_unique_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_unique_pairs</span></code></a>([self_interaction])</p></td>
<td><p>Find unique neighbor pairs within the geometry.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.geom.NeighborFinder.setup" title="sisl.geom.NeighborFinder.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>([geometry, R, overlap, bin_size])</p></td>
<td><p>Prepares everything for neighbor finding.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sisl.geom.NeighborFinder.memory" title="sisl.geom.NeighborFinder.memory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">memory</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.assert_consistency">
<span class="sig-name descname"><span class="pre">assert_consistency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/sisl/geom/_neighbors/_finder.html#NeighborFinder.assert_consistency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sisl.geom.NeighborFinder.assert_consistency" title="Link to this definition"></a></dt>
<dd><p>Asserts that the data structure (self._list, self._heads, self._counts) is consistent.</p>
<p>It also stores that the shape is consistent with the stored geometry and the store total_nbins.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.find_close">
<span class="sig-name descname"><span class="pre">find_close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/sisl/geom/_neighbors/_finder.html#NeighborFinder.find_close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sisl.geom.NeighborFinder.find_close" title="Link to this definition"></a></dt>
<dd><p>Find all atoms that are close to some coordinates in space.</p>
<p>This routine only executes the action of finding neighbors,
the parameters of the search (<em class="xref py py-obj">geometry</em>, <em class="xref py py-obj">R</em>, <em class="xref py py-obj">overlap</em>…)
are defined when the finder is initialized or by calling <a class="reference internal" href="#sisl.geom.NeighborFinder.setup" title="sisl.geom.NeighborFinder.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array-like</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">([npoints]</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">3)</span></code>) – the coordinates for which neighbors are desired.</p></li>
<li><p><strong>as_pairs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <em class="xref py py-obj">True</em> pairs are returned, where the first item is the index
of the point and the second one is the atom index.
Otherwise a list containing the neighbors for each point is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sisl.geom.PointsNeighborList.html#sisl.geom.PointsNeighborList" title="sisl.geom.PointsNeighborList"><em>PointsNeighborList</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.find_neighbors">
<span class="sig-name descname"><span class="pre">find_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/sisl/geom/_neighbors/_finder.html#NeighborFinder.find_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sisl.geom.NeighborFinder.find_neighbors" title="Link to this definition"></a></dt>
<dd><p>Find neighbors as specified in the finder.</p>
<p>This routine only executes the action of finding neighbors,
the parameters of the search (<em class="xref py py-obj">geometry</em>, <em class="xref py py-obj">R</em>, <em class="xref py py-obj">overlap</em>…)
are defined when the finder is initialized or by calling <a class="reference internal" href="#sisl.geom.NeighborFinder.setup" title="sisl.geom.NeighborFinder.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>optional</em>) – <p>the atoms for which neighbors are desired. Anything that can
be sanitized by <a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.Geometry</span></code></a> is a valid value.</p>
<p>If not provided, neighbors for all atoms are searched.</p>
</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – whether to consider an atom a neighbor of itself.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The neighbors list. It will be a partial list if <em class="xref py py-obj">atoms</em> is provided.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">neighbors</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.find_unique_pairs">
<span class="sig-name descname"><span class="pre">find_unique_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/sisl/geom/_neighbors/_finder.html#NeighborFinder.find_unique_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sisl.geom.NeighborFinder.find_unique_pairs" title="Link to this definition"></a></dt>
<dd><p>Find unique neighbor pairs within the geometry.</p>
<p>This function only returns one direction of a given connection
between atoms i and j. In particular, it returns the connection
where i &lt; j.</p>
<p>Note that this routine can not be called if <em class="xref py py-obj">overlap</em> is
set to <em class="xref py py-obj">False</em> and the radius is not a single float. In that case,
there is no way of defining “uniqueness” since pair <em class="xref py py-obj">ij</em> can have
a different threshold radius than pair <em class="xref py py-obj">ji</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>optional</em>) – <p>the atoms for which neighbors are desired. Anything that can
be sanitized by <a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.Geometry</span></code></a> is a valid value.</p>
<p>If not provided, neighbors for all atoms are searched.</p>
</p></li>
<li><p><strong>as_pairs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – If <em class="xref py py-obj">True</em> pairs of atoms are returned. Otherwise a list containing
the neighbors for each atom is returned.</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – whether to consider an atom a neighbor of itself.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="sisl.geom.UniqueNeighborList.html#sisl.geom.UniqueNeighborList" title="sisl.geom.UniqueNeighborList"><em>UniqueNeighborList</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/sisl/geom/_neighbors/_finder.html#NeighborFinder.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sisl.geom.NeighborFinder.setup" title="Link to this definition"></a></dt>
<dd><p>Prepares everything for neighbor finding.</p>
<p><strong>You don’t need to call this method after initializing the finder</strong>,
this is called internally already!</p>
<p>This method migh be used to reset the finder with new parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">sisl.Geometry</span></code></a>, <em>optional</em>) – <p>the geometry to find neighbors in.</p>
<p>If not provided, the current geometry is kept.</p>
</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">array-like</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">shape</span> <span class="pre">(geometry.na)</span></code>, <em>optional</em>) – <p>The radius to consider two atoms neighbors.
If it is a single float, the same radius is used for all atoms.
If it is an array, it should contain the radius for each atom.</p>
<p>If not provided, an array is constructed, where the radius for
each atom is its maxR.</p>
<p>Note that negative R values are allowed</p>
</p></li>
<li><p><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If <em class="xref py py-obj">True</em>, two atoms are considered neighbors if their spheres
overlap.
If <em class="xref py py-obj">False</em>, two atoms are considered neighbors if the second atom
is within the sphere of the first atom. Note that this implies that
atom <code class="docutils literal notranslate"><span class="pre">i</span></code> might be atom <code class="docutils literal notranslate"><span class="pre">j</span></code>’s neighbor while the opposite is not true.</p></li>
<li><p><strong>bin_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – the factor for the radius to determine how large the bins are,
optionally along each lattice vector.
It can minimally be 2, meaning that the maximum radius to consider
is twice the radius considered. For larger values, more atoms will be in
each bin (and thus fewer bins).
Hence, this value can be used to fine-tune the memory requirement by
decreasing number of bins, at the cost of a bit more run-time searching
bins.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.R">
<span class="sig-name descname"><span class="pre">R</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span></em><a class="headerlink" href="#sisl.geom.NeighborFinder.R" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.geometry">
<span class="sig-name descname"><span class="pre">geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../generated/sisl.Geometry.html#sisl.Geometry" title="sisl.Geometry"><span class="pre">Geometry</span></a></em><a class="headerlink" href="#sisl.geom.NeighborFinder.geometry" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.memory">
<span class="sig-name descname"><span class="pre">memory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('200MB',</span> <span class="pre">1.5)</span></em><a class="headerlink" href="#sisl.geom.NeighborFinder.memory" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.nbins">
<span class="sig-name descname"><span class="pre">nbins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sisl.geom.NeighborFinder.nbins" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sisl.geom.NeighborFinder.total_nbins">
<span class="sig-name descname"><span class="pre">total_nbins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#sisl.geom.NeighborFinder.total_nbins" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../neighbors.html" class="btn btn-neutral float-left" title="Finding neighbors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sisl.geom.FullNeighborList.html" class="btn btn-neutral float-right" title="sisl.geom.FullNeighborList" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2025, sisl developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>