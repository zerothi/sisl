<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Electronic structure setup – part 2 &mdash; sisl 0.1.dev1+g851d78c documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Command line scripts" href="../scripts/scripts.html" />
    <link rel="prev" title="Electronic structure setup – part 1" href="tutorial_05.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> sisl
          </a>
              <div class="version">
                0.1.dev1+g851d78c
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_es_1.html">Electronic structure calculation – a walk-through</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_es_2.html">Berry phase calculation for graphene</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#siesta-transiesta-support">Siesta/TranSiesta support</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#deprecated-tutorials">Deprecated tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tutorial_01.html">Geometry creation -- part 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_02.html">Geometry creation -- part 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_04.html">Supercells</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_05.html">Electronic structure setup -- part 1</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Electronic structure setup -- part 2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Toolboxes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../toolbox/index.html">Toolboxes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../visualization/ase/index.html">ASE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/viz_module/index.html">The <code class="docutils literal notranslate"><span class="pre">sisl.viz</span></code> module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Electronic structure setup – part 2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/tutorial_06.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="electronic-structure-setup-part-2">
<span id="tutorial-06"></span><h1>Electronic structure setup – part 2<a class="headerlink" href="#electronic-structure-setup-part-2" title="Permalink to this heading"></a></h1>
<p>Following <a class="reference internal" href="tutorial_05.html#tutorial-05"><span class="std std-ref">part 1</span></a> we focus on how to generalize the specification
of the hopping parameters in a more generic way.</p>
<p>First, we re-create the square geometry (with one orbital per atom). However,
to generalize the specification of the hopping parameters it is essential that
we specify how long range the orbitals interact. In the following we set the
atomic specie to be a Hydrogen atom with a single orbital with a range of <span class="math notranslate nohighlight">\(1\,Å\)</span></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Hydrogen</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">square</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">Hydrogen</span><span class="p">,</span>
<span class="go">                      sc=SuperCell([1, 1, 10], [3, 3, 1]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">{spin: 1, non-zero: 0</span>
<span class="go"> {na: 1, no: 1, species:</span>
<span class="go">  {Atoms(1):</span>
<span class="go">    (1) == [H, Z: 1, orbs: 1, mass(au): 1.00794, maxR: 1.00000],</span>
<span class="go">  },</span>
<span class="go">  nsc: [3, 3, 1], maxR: 1.0</span>
<span class="go"> }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Note how the <code class="docutils literal notranslate"><span class="pre">maxR</span></code> variable has changed from <code class="docutils literal notranslate"><span class="pre">-1.0</span></code> to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>. This corresponds to the
maximal orbital range in the geometry. Here there is only one type of orbital, but for
geometries with several different orbitals, there may be different orbital ranges.</p>
<p>Now one can assign the generalized parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ia</span> <span class="ow">in</span> <span class="n">square</span><span class="p">:</span> <span class="c1"># loop atomic indices (here equivalent to the orbital indices)</span>
<span class="gp">... </span>    <span class="n">idx_a</span> <span class="o">=</span> <span class="n">square</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">H</span><span class="p">[</span><span class="n">ia</span><span class="p">,</span> <span class="n">idx_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.</span>
<span class="gp">... </span>    <span class="n">H</span><span class="p">[</span><span class="n">ia</span><span class="p">,</span> <span class="n">idx_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>
</pre></div>
</div>
<p>The <em class="xref py py-obj">Geometry.close</em> function is a convenience function to return atomic indices of
atoms within a certain radius. For instance <code class="docutils literal notranslate"><span class="pre">close(0,</span> <span class="pre">R=1.)</span></code> returns all atomic
indices within a spherical radius of <span class="math notranslate nohighlight">\(1\,Å\)</span> from the first atom in the geometry,
including it-self.
<code class="docutils literal notranslate"><span class="pre">close([0.,</span> <span class="pre">0.,</span> <span class="pre">1.],</span> <span class="pre">R=1.)</span></code> will return all atomic indices within <span class="math notranslate nohighlight">\(1\,Å\)</span> of the
coordinate <code class="docutils literal notranslate"><span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]</span></code>.
If one specifies a list of <code class="docutils literal notranslate"><span class="pre">R</span></code> it will return the atomic indices in the sphere within the
first element; and for the later values it will return the atomic indices in the spherical
shell between the corresponding radii and the previous radii.</p>
<p>The above code is the preferred method of creating a Hamiltonian. It is safe because it ensures
that all parameters are set, and symmetrized.</p>
<p>For very large geometries (larger than 50,000 atoms) the above code will be <em>extremely</em> slow.
Hence, the preferred method to setup the Hamiltonian for these large geometries is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ias</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="n">square</span><span class="o">.</span><span class="n">iter_block</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">ia</span> <span class="ow">in</span> <span class="n">ias</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">idx_a</span> <span class="o">=</span> <span class="n">square</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="n">idx</span><span class="o">=</span><span class="n">idxs</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">H</span><span class="p">[</span><span class="n">ia</span><span class="p">,</span> <span class="n">idx_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.</span>
<span class="gp">... </span>       <span class="n">H</span><span class="p">[</span><span class="n">ia</span><span class="p">,</span> <span class="n">idx_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>
</pre></div>
</div>
<p>The code above is the preferred method of specifying the Hamiltonian
parameters.</p>
<p>The complete code for this example (plus the band-structure) can be found
<a class="reference download internal" download="" href="../_downloads/c8fbe3974e883e2f7d34bf5b55d50266/tutorial_06_square.py"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_05.html" class="btn btn-neutral float-left" title="Electronic structure setup – part 1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../scripts/scripts.html" class="btn btn-neutral float-right" title="Command line scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2023, Nick Papior.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>